!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4153b60f-260b-313c-bb50-3a8cfd5b3f90")}catch(e){}}();
define(["require","exports","react","./e_file_viewer_static_scl_page_file","./e_data_modules_stormcrow","./c_over-quota_utils_use_get_plans","./c_core_i18n","./c_growth-components_over-quota-file-viewer-modal","./c_over-quota_utils_oq_price_decrease_helper","./e_edison","./c_bem","./c_chat_chat_constants","./c_spectrum_util_raf_throttle","./e_core_exception","./c_init_data_edison","./c_dotlottie_common_chunk-B7OIQIGJ","./c_src_sink_index","./c_lodash-es_lodash","./c_react-use_misc_util","./c_api_v2_routes_restorations_provider","./c_api_v2_unauthed_client","./c_hive_schemas_sharing-request_access_user_events","./c_core_notify","react-dom","./c_api_v2_routes_team_insights_provider","./c_security_csrf_hmac","./c_react-use_useEffectOnce","./c_pap-events_navigation_select_create_folder_action","react/jsx-runtime","./c_trial-plan-card_components_header","./c_dig-components_combinations_index","./c_dig-icons_assets_ui-icon_line_tag","./c_trial-cards_trial-plan-card","./c_dig-components_meter_index","./c_react-hookz_web_useRafCallback","metaserver/static/js/langpack","./c_custom_campaigns_out_of_space_modal_out_of_space_checkout_modal_logger"],(function(e,t,o,a,n,i,l,r,_,s,d,c,u,m,w,v,p,f,g,C,y,h,S,M,E,b,O,P,k,x,L,I,T,q,B,N,R){"use strict";function A(e){return e&&e.__esModule?e:{default:e}}var D=A(o);a.injectInternalStyle("/static/js/growth-components/auto-layout-modal/index.module.out-vflGbaM3w.css",(e=>"._bannerSection_6ww7a_1{margin-bottom:var(--dig-spacing__macro__small);margin-top:var(--dig-spacing__micro__small)}._sideBySideContentContainer_6ww7a_6{align-items:stretch;column-gap:var(--dig-spacing__macro__small);display:flex;flex-direction:row}._sideBySideContentItem_6ww7a_13{flex:1}._footer_6ww7a_17{display:flex;flex-wrap:wrap-reverse;gap:var(--dig-spacing__dimension__8)}._autoLayoutModalMobile_6ww7a_23{._bannerSection_6ww7a_1{margin:var(--dig-spacing__micro__large) calc(var(--dig-spacing__macro__small)*-1)}._sideBySideContentContainer_6ww7a_6{align-items:stretch;flex-direction:column;margin-top:var(--dig-spacing__macro__xsmall);row-gap:var(--dig-spacing__macro__small)}._sideBySideContentItem_6ww7a_13{flex-grow:0}}._autoLayoutModalMobile_6ww7a_23._mobileCentered_6ww7a_43{._sideBySideContentContainer_6ww7a_6{display:block}._title_6ww7a_48{text-align:center}._sideBySideContentItem_6ww7a_13{align-items:center;display:flex;justify-content:center}._secondSideBySideContentItem_6ww7a_58{margin-top:var(--dig-spacing__dimension__24)}._footer_6ww7a_17{align-items:center;flex-direction:column-reverse}._footerButton_6ww7a_67{margin:auto}}._expandableModal_6ww7a_72{width:fit-content!important}"));const U="_bannerSection_6ww7a_1",V="_sideBySideContentContainer_6ww7a_6",Q="_sideBySideContentItem_6ww7a_13",W="_footer_6ww7a_17",F="_autoLayoutModalMobile_6ww7a_23",G="_mobileCentered_6ww7a_43",H="_title_6ww7a_48",z="_secondSideBySideContentItem_6ww7a_58",j="_expandableModal_6ww7a_72",K=({title:e,bannerOptions:t,firstChild:o,secondChild:n,primaryCtaText:i,primaryCtaOnClick:l,primaryCtaProps:r,secondaryCtaText:_,secondaryCtaOnClick:s,secondaryCtaProps:d,showCloseButton:c,onCloseButtonClick:u,width:m=600,centerMobileView:w=!1,minWidth:v=366,maxWidth:p,isPrimaryCtaLoading:f=!1})=>{const[g,C]=D.default.useState(window.innerWidth<=m);D.default.useLayoutEffect((()=>{function e(){C(window.innerWidth<=m)}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[m]);const y=t&&D.default.createElement(a.Box,{className:U},D.default.createElement(a.Banner,{type:t.type,borderRadius:g?"None":"Large"},D.default.createElement(a.Banner.Message,null,t.text),t.ctaText&&D.default.createElement(a.Banner.Actions,null,D.default.createElement(a.Button,{variant:"transparent",onClick:t.ctaOnClick},t.ctaText)))),h=a.cx({[F]:g,[G]:g&&w,[j]:void 0!==p&&!g});return D.default.createElement(a.Modal,{open:!0,withCloseButton:c?"Close":void 0,onRequestClose:e=>null==u?void 0:u(e),width:m,className:h,fullScreen:g,contentStyles:g?void 0:{minWidth:`${v}px`,maxWidth:p?`${p}px`:void 0}},D.default.createElement(a.Modal.Header,null,g&&y,D.default.createElement(a.Modal.Title,{className:H},e)),D.default.createElement(a.Modal.Body,null,!g&&y,D.default.createElement(a.Box,{className:V},D.default.createElement(a.Box,{className:Q},o),n&&D.default.createElement(a.Box,{className:a.cx(Q,z)},n))),D.default.createElement(a.Modal.Footer,{className:W},_&&D.default.createElement(a.Button,{variant:"opacity",onClick:s,...d},_),D.default.createElement(a.Button,{variant:"primary",onClick:l,isLoading:f,...r},i)))};K.displayName="AutoLayoutModal";const $="OVER_QUOTA_RESTRICTIONS_MODAL",J=({action:t,continueCallback:n,abortCallback:s,filePreview:d,fileName:c,downloadFileHandler:u})=>{var m,w,v,p,f,g,C,y,h,S;const[M,E]=D.default.useState(!1),{user:b}=a.useActiveUser(),{quotaUpsellInfo:O,isLoadingQuotaUpsellInfo:P}=a.useQuotaUpsellInfo(b),{shouldUseSmallSkus:k}=_.useOverquotaPriceDecrease(b),{plansInfo:x,isLoadingPlansInfo:L}=i.useGetPlans({planNames:["basic","plus"],revenueContentLocation:"oq_restrictions_modal"}),{plansInfo:I,isLoadingPlansInfo:T}=i.useGetPlans({planNames:["basic","basic500"],revenueContentLocation:"oq_smaller_skus_modal"}),q=k?I:x,B=k?T:L,N=o.useRef(!1),R="ON"===a.useExperimentVariant("overquota_glide_modal").variant,A=(null===(m=null==O?void 0:O.quota)||void 0===m?void 0:m.used)||0,U=i.getViewMode(t),[V,Q]=D.default.useState(window.innerWidth<=i.OVER_QUOTA_RESTRICTIONS_MODAL_MIN_WIDTH_DESKTOP);D.default.useLayoutEffect((()=>{function e(){Q(window.innerWidth<=i.OVER_QUOTA_RESTRICTIONS_MODAL_MIN_WIDTH_DESKTOP)}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const W=(null===(p=null===(v=null===(w=null==O?void 0:O.quota)||void 0===w?void 0:w.allocation)||void 0===v?void 0:v.individual)||void 0===p?void 0:p.allocated)||0,F=U!==i.ViewMode.UploadOrCreate&&((null===(f=null==O?void 0:O.restrictions)||void 0===f?void 0:f.show_restrictions_warning)||!1),G=void 0!==(null===(g=null==O?void 0:O.quota)||void 0===g?void 0:g.used)&&void 0!==(null===(C=null==x?void 0:x.PLUS)||void 0===C?void 0:C.quota_bytes)&&O.quota.used<x.PLUS.quota_bytes,H=a.getOverQuotaReason(null==O?void 0:O.overquota_reason),z=null!==(y=_.getOrganicOrChurnedFromString(H))&&void 0!==y?y:"unlabeled",j=null===(h=null==O?void 0:O.restrictions)||void 0===h?void 0:h.overquota_start_time_utc_seconds,J=j?Date.now()/1e3-j:void 0,X=(null===(S=null==O?void 0:O.restrictions)||void 0===S?void 0:S.show_restrictions_warning)&&!!j&&0!==j,Y=k?"dropbox500":q&&G?"plus":"none",Z=o.useMemo((()=>({overQuotaSweepBlockingModalAction:t,quotaLimit:W,quotaUsed:A,organicOrChurned:z,secondsOverquota:J,hardblocked:!F,planShown:Y,restrictionsStartDateShown:X})),[W,A,z,J,F,t,q,G,X]);if(o.useEffect((()=>{B||P||N.current||(_.logShownOverquotaRestrictionsModal(Z),N.current=!0)}),[Z,B,P]),o.useEffect((()=>{B||P||N.current||(new Promise((function(t,o){e(["./c_custom_campaigns_out_of_space_modal_out_of_space_modal_doorman_wrapper"],t,o)})),new Promise((function(t,o){e(["./c_checkout_components_portable_checkout_frame"],t,o)})).then((function(e){return e.portable_checkout_frame_esnext})))}),[B,P]),B||P)return null;const ee=()=>{_.logSelectOverquotaRestrictionsModal("view_plans",Z),R?(E(!0),a.openDoormanUpsellModal({modalVersion:"glide-upsell-modal-dp-only",trialCardsLocation:a.TrialCardsLocation.OVERQUOTA_RESTRICTIONS_MODAL,reloadPageAfterPurchase:!0,onClose:()=>{F?n():s()},onDisplayed:()=>{a.unmountModal(void 0,$),E(!1)}})):(s(),a.redirect("/out-of-space?_tk=oq_restrictions_modal"),a.unmountModal(void 0,$))},te=()=>{_.logSelectOverquotaRestrictionsModal("manage_files",Z),a.redirect("/home?_tk=oq_restrictions_modal&pathway=download_and_delete_tooltip_tour&sort_by_size_desc=true"),s(),a.unmountModal(void 0,$)};let oe;u&&(oe=()=>{_.logSelectOverquotaRestrictionsModal("download_file",Z),null==u||u()});if(U===i.ViewMode.Preview&&!F&&!G&&!V)return D.default.createElement(l.Provider,{value:l.intl},D.default.createElement(r.OverQuotaFileViewerModal,{open:!0,onClose:()=>{n(),a.unmountModal(void 0,$)},headerText:i.PREVIEW_TITLE(c||""),bodyText:i.OVER_QUOTA_DELETION_WARNING(a.format_bytes(l.intl,A),a.format_bytes(l.intl,W)),badgeText:i.WARNING_BADGE,ctaText:i.VIEW_PLANS,onCtaClick:ee,filePreview:d,secondaryCtaText:i.MANAGE_FILES,secondaryCtaOnClick:te,tertiaryCtaText:i.DOWNLOAD_FILE,tertiaryCtaOnClick:oe,showCloseButton:!1,isPrimaryCtaLoading:M}));const ae=i.getAutoLayoutModalProps({viewMode:U,isMobileView:V,fileName:c,quotaUpsellInfo:O,warningMode:F,usedLessThanPlusQuota:G,filePreview:d,planContent:q,quotaUsedBytes:A,quotaAllocatedBytes:W,shouldUseSmallSkus:k,onViewPlansClick:ee,onCloseClick:e=>{e.preventDefault(),e.stopPropagation(),_.logSelectOverquotaRestrictionsModal("close_button",Z),F?n():s(),a.unmountModal(void 0,$)},onDownloadFileClick:oe,onManageFilesClick:te,onGetPlanClick:()=>{_.logSelectOverquotaRestrictionsModal("get_plan",Z),i.openPortableCheckoutModal({isOpen:!0,productPlanType:k?a.ProductPlanType.BASIC_PLUS:a.ProductPlanType.PLUS,onCloseClick:()=>{F?n():s(),a.unmountModal(void 0,i.PORTABLE_CHECKOUT_MODAL_ID)},onIframeLoadSuccess:()=>{_.logShownPortableCheckoutModalSuccess(),a.unmountModal(void 0,$)},onIframeLoadError:()=>{s(),_.logShownPortableCheckoutModalError(),a.unmountModal(void 0,$),k?a.redirect("/buy/dbx500?_tk=oq_restrictions_modal"):a.redirect("/buy/plus?_tk=oq_restrictions_modal")},onPurchaseSuccess:()=>{s(),_.logSelectPortableCheckoutModalPurchaseSuccess(),a.reload()}})}});return D.default.createElement(l.Provider,{value:l.intl},D.default.createElement(K,{...ae,isPrimaryCtaLoading:M}))};J.displayName="FunctionalOverQuotaRestrictionsModal";t.openOverQuotaRestrictionsModal=e=>{a.mountModal(D.default.createElement(n.QueryClientProvider,{client:n.queryClient},D.default.createElement(J,{action:e.action,continueCallback:e.continueCallback,abortCallback:e.abortCallback,filePreview:e.filePreview,fileName:e.fileName,downloadFileHandler:e.downloadFileHandler})),void 0,$)}}));
//# sourceMappingURL=c_over-quota_over-quota-sweep-blocking-modal_open_over_quota_restrictions_modal.js-vflu9_0mq.map

//# debugId=4153b60f-260b-313c-bb50-3a8cfd5b3f90