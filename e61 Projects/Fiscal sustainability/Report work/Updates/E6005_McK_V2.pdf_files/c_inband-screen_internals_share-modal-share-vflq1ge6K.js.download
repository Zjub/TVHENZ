!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="800d496f-9984-3f95-ac72-4ad18387e0b2")}catch(e){}}();
define(["require","exports","./e_file_viewer_static_scl_page_file","react","./c_core_i18n","./c_abuse_fingerprintjs_abuse_fpjs_provider","./c_browse_welcome_hub_lib_types","./c_src_utils_initials","./c_utils_dsx_dsx-react","./e_data_modules_stormcrow","./c_common_components_buttons","./c_abuse_fingerprintjs_abuse_fpjs_context","./c_contacts_contact","./c_validators","./e_edison","./c_proto_storefront_platform_js_init_data_types_pb","./c_components_change_plan_utils","./c_proto_storefront_platform_js_init_data_transition_pb","./c_spectrum_util_raf_throttle","./c_proto_checkout_js_init_data_checkout_page_pb","./c_proto_storefront_platform_js_init_data_usage_data_pb","./c_init_data_edison","./c_sharing_sharing_pap_logging_send_share_invite_util","./e_core_exception","./c_chat_chat_constants","./c_dig-components_chip_index","./c_dig-components_typeahead_index","./c_over-quota_over-quota-sweep-blocking-modal_show_over_quota_modal_or_continue","./c_dig-icons_assets_ui-icon_line_share"],(function(e,t,a,n,i,r,o,s,l,d,_,c,u,m,g,p,f,h,y,v,E,T,S,w,A,I,b,k,R){"use strict";function N(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var M=N(n);function C(e){return e.requested_visibility===a.RequestedVisibilityPolicy.password||e.require_password}function L(e){return e.audience_options.filter((e=>"password"===e.audience&&e.allowed)).length>0}function x(e){if(e.effective_audience)return e.effective_audience;switch(e.resolved_visibility){case"public":case"password":case"no_one":return e.resolved_visibility;case"team_only":return"team";case"team_and_password":return"password";case"shared_folder_only":case"only_you":return"no_one"}}const P={day_1:1,day_3:3,day_7:7,day_30:30,day_90:90,day_180:180,year_1:365};function O(e){return["public","password"].includes(e)}function D(e){return!!e.days_to_expire_policy&&"none"!==e.days_to_expire_policy}function F(e){return!!e.enforce_shared_link_password_policy&&"required"===e.enforce_shared_link_password_policy}function $(e){return D(e)&&!!e.change_shared_link_expiration_policy&&"not_allowed"===e.change_shared_link_expiration_policy}function U(e,t){return O(e.audience)&&(!e.expires&&$(t)||!C(t)&&F(t))}const H=(e,t)=>Boolean(!e||t);function B(e,t,a=!1){return e.filter((e=>void 0!==e.email)).map((e=>({email:e.email,checkForInvite:t,isResurface:a})))}function q(e,t,a){return[...B(e,!0),...B(a,!0,!0),...B(t,!1)]}function J(e){return["member_invite_expand_eligibility","member_suggestion_expand_eligibility","member_invite_partial_eligibility"].includes(e)}function V(e,t,a){const n=e.length>0,i=t.length>0,r=(n||i)&&(function(e){return["admin_invite_after_move","admin_invite_expand_eligibility"].includes(e)}(a)||J(a));return Boolean(r)}const j=e=>a.create("email",{email:e}),W=e=>"user"===e[".tag"]?""===e.dbx_account_id?`EMAIL:${e.email}`:`DBX_ID:${e.dbx_account_id}`:"group"===e[".tag"]?`DBX_ID:${e.group_id}`:"email"===e[".tag"]?`EMAIL:${e.email}`:a.exhausts(e,"UNKNOWN"),G=e=>"user"===e[".tag"]&&e.photo_url||null,z=(e,t)=>"user"===e[".tag"]||"email"===e[".tag"]?e.email:"group"===e[".tag"]?t.formatMessage({id:"XMHn5C",defaultMessage:"{count, plural, one{# member} other{# members}}"},{count:e.group_size||0}):"",K=e=>"email"===e[".tag"]?{".tag":"email",email:e.email}:"group"===e[".tag"]?{".tag":"dropbox_id",dropbox_id:e.group_id}:"user"===e[".tag"]?""===e.dbx_account_id?{".tag":"email",email:e.email}:{".tag":"dropbox_id",dropbox_id:e.dbx_account_id}:{".tag":"other"},Y={".tag":"public"},Z={".tag":"team_only"},Q={".tag":"password"},X={".tag":"team_and_password"},ee={".tag":"shared_folder_only"},te={".tag":"no_one"},ae={".tag":"only_you"},ne={".tag":"other"},ie={".tag":"day_1"},re={".tag":"day_180"},oe={".tag":"day_3"},se={".tag":"day_30"},le={".tag":"day_7"},de={".tag":"day_90"},_e={".tag":"none"},ce={".tag":"year_1"},ue={".tag":"other"},me={".tag":"allowed"},ge={".tag":"not_allowed"},pe={".tag":"other"},fe={".tag":"optional"},he={".tag":"required"},ye={".tag":"other"},ve={".tag":"admin_invite_expand_eligibility"},Ee={".tag":"member_suggestion_expand_eligibility"},Te={".tag":"member_invite_expand_eligibility"},Se={".tag":"member_invite_partial_eligibility"},we={".tag":"not_enabled"},Ae={".tag":"anyone"},Ie={".tag":"team"},be={".tag":"team_and_approved"},ke={".tag":"other"},Re={".tag":"from_team_only"},Ne={".tag":"from_anyone"},Me={".tag":"other"},Ce={".tag":"default_public"},Le={".tag":"default_team_only"},xe={".tag":"team_only"},Pe={".tag":"default_no_one"},Oe={".tag":"other"},De={".tag":"admins_and_members"},Fe={".tag":"admins_only"},$e={".tag":"members"},Ue={".tag":"anyone"},He={".tag":"other"},Be={".tag":"optional"},qe={".tag":"required"},Je={".tag":"other"},Ve={".tag":"day_1"},je={".tag":"day_180"},We={".tag":"day_3"},Ge={".tag":"day_30"},ze={".tag":"day_7"},Ke={".tag":"day_90"},Ye={".tag":"none"},Ze={".tag":"year_1"},Qe={".tag":"other"},Xe={".tag":"default"},et={".tag":"edit"},tt={".tag":"view"},at=e=>"email"===e[".tag"]?u.Contact.buildFromRawEmail(e.email):"group"===e[".tag"]?new u.Contact({type:a.ContactTypes.NEW_STYLE_GROUP,dbx_team_id:e.dbx_team_id,members:e.members,name:e.name,group_id:e.group_id,group_size:e.group_size}):"user"===e[".tag"]?e.dbx_account_id?new u.Contact({type:a.ContactTypes.EMAIL,dbx_team_id:e.dbx_team_id,...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,invalid:!m.validateEmail(e.email),dbx_account_id:e.dbx_account_id,email:e.email}):u.Contact.buildFromRawEmail(e.email):a.exhausts(e,u.Contact.buildFromRawEmail("")),nt=e=>"invalid"===e.state?{".tag":"disallowed",disallowed:{".tag":"other"}}:"ok"===e.state?"NOT_DROPBOX_USER"===e.msg?{".tag":"allowed",allowed:{".tag":"not_dropbox_user"}}:{".tag":"allowed",allowed:{".tag":"no_warning"}}:"warn"===e.state?e.msg===a.CONTACT_ERROR_MESSAGES.OUT_OF_TEAM?{".tag":"allowed",allowed:{".tag":"outside_of_team"}}:{".tag":"allowed",allowed:{".tag":"other"}}:{".tag":"other"},it=e=>"owner"===e?s.OWNER:"reader"===e?s.VIEWER:"writer"===e?s.EDITOR:"reader_no_comment"===e?s.VIEWER_NO_COMMENT:s.OTHER,rt=e=>void 0===e?a.OTHER:"editor"===e?a.EDITOR:"viewer"===e?a.VIEWER:a.exhausts(e,a.OTHER),ot=e=>"public"===e?Y:"team_only"===e?Z:"password"===e?Q:void 0,st=e=>"public"===e?a.PUBLIC:"team"===e?a.TEAM:"password"===e?a.PASSWORD:"no_one"===e?a.NO_ONE:a.OTHER$1,lt=e=>{var t,a,n,i,r,o,s,l,d,_,c,u,m;const g=[];return void 0===e||(void 0!==(null===(t=e.change_options)||void 0===t?void 0:t.allow)&&g.push({action:{".tag":"change_options"},allow:e.change_options.allow}),void 0!==(null===(a=e.disable_viewer_info)||void 0===a?void 0:a.allow)&&g.push({action:{".tag":"disable_viewer_info"},allow:e.disable_viewer_info.allow}),void 0!==(null===(n=e.edit_contents)||void 0===n?void 0:n.allow)&&g.push({action:{".tag":"edit_contents"},allow:e.edit_contents.allow}),void 0!==(null===(i=e.enable_viewer_info)||void 0===i?void 0:i.allow)&&g.push({action:{".tag":"enable_viewer_info"},allow:e.enable_viewer_info.allow}),void 0!==(null===(r=e.invite_editor)||void 0===r?void 0:r.allow)&&g.push({action:{".tag":"invite_editor"},allow:e.invite_editor.allow}),void 0!==(null===(o=e.invite_viewer)||void 0===o?void 0:o.allow)&&g.push({action:{".tag":"invite_viewer"},allow:e.invite_viewer.allow}),void 0!==(null===(s=e.invite_viewer_no_comment)||void 0===s?void 0:s.allow)&&g.push({action:{".tag":"invite_viewer_no_comment"},allow:e.invite_viewer_no_comment.allow}),void 0!==(null===(l=e.leave_a_copy)||void 0===l?void 0:l.allow)&&g.push({action:{".tag":"leave_a_copy"},allow:e.leave_a_copy.allow}),void 0!==(null===(d=e.relinquish_membership)||void 0===d?void 0:d.allow)&&g.push({action:{".tag":"relinquish_membership"},allow:e.relinquish_membership.allow}),void 0!==(null===(_=e.update_confidentiality)||void 0===_?void 0:_.allow)&&g.push({action:{".tag":"update_confidentiality"},allow:e.update_confidentiality.allow}),void 0!==(null===(c=e.unmount)||void 0===c?void 0:c.allow)&&g.push({action:{".tag":"unmount"},allow:e.unmount.allow}),void 0!==(null===(u=e.unshare)||void 0===u?void 0:u.allow)&&g.push({action:{".tag":"unshare"},allow:e.unshare.allow}),void 0!==(null===(m=e.create_link)||void 0===m?void 0:m.allow)&&g.push({action:{".tag":"create_link"},allow:e.create_link.allow})),g},dt=e=>{var t,a,n,i,r,o,s,l,d,_,c,u,m,g,p;const f=[];return void 0===e||(void 0!==(null===(t=e.create_edit_link)||void 0===t?void 0:t.allow)&&f.push({action:{".tag":"create_edit_link"},allow:e.create_edit_link.allow}),void 0!==(null===(a=e.create_view_link)||void 0===a?void 0:a.allow)&&f.push({action:{".tag":"create_view_link"},allow:e.create_view_link.allow}),void 0!==(null===(n=e.change_options)||void 0===n?void 0:n.allow)&&f.push({action:{".tag":"change_options"},allow:e.change_options.allow}),void 0!==(null===(i=e.disable_viewer_info)||void 0===i?void 0:i.allow)&&f.push({action:{".tag":"disable_viewer_info"},allow:e.disable_viewer_info.allow}),void 0!==(null===(r=e.edit_contents)||void 0===r?void 0:r.allow)&&f.push({action:{".tag":"edit_contents"},allow:e.edit_contents.allow}),void 0!==(null===(o=e.enable_viewer_info)||void 0===o?void 0:o.allow)&&f.push({action:{".tag":"enable_viewer_info"},allow:e.enable_viewer_info.allow}),void 0!==(null===(s=e.invite_viewer)||void 0===s?void 0:s.allow)&&f.push({action:{".tag":"invite_viewer"},allow:e.invite_viewer.allow}),void 0!==(null===(l=e.invite_editor)||void 0===l?void 0:l.allow)&&f.push({action:{".tag":"invite_editor"},allow:e.invite_editor.allow}),void 0!==(null===(d=e.invite_viewer_no_comment)||void 0===d?void 0:d.allow)&&f.push({action:{".tag":"invite_viewer_no_comment"},allow:e.invite_viewer_no_comment.allow}),void 0!==(null===(_=e.relinquish_membership)||void 0===_?void 0:_.allow)&&f.push({action:{".tag":"relinquish_membership"},allow:e.relinquish_membership.allow}),void 0!==(null===(c=e.remove_download_policy)||void 0===c?void 0:c.allow)&&f.push({action:{".tag":"remove_download_policy"},allow:e.remove_download_policy.allow}),void 0!==(null===(u=e.set_download_policy)||void 0===u?void 0:u.allow)&&f.push({action:{".tag":"set_download_policy"},allow:e.set_download_policy.allow}),void 0!==(null===(m=e.unshare)||void 0===m?void 0:m.allow)&&f.push({action:{".tag":"unshare"},allow:e.unshare.allow}),void 0!==(null===(g=e.create_link)||void 0===g?void 0:g.allow)&&f.push({action:{".tag":"create_link"},allow:e.create_link.allow}),void 0!==(null===(p=e.share_message_as_comment)||void 0===p?void 0:p.allow)&&f.push({action:{".tag":"share_message_as_comment"},allow:e.share_message_as_comment.allow})),f},_t=(e,t,a)=>{var n,i,r,o,s,l,d,_;if(void 0===e)throw new Error("Adapter error.");if(e.isFolder()){if(e.isNewSharedFolder()){const n=e;return{".tag":"file_folder",access_type:it(e.access_type),is_inside_team_folder:t,is_team_folder:a,owner_team:n.owner_team,parent_shared_folder_id:n.parent_shared_folder_id?String(n.parent_shared_folder_id):void 0,path_lower:n.path_lower,parent_folder_name:n.parent_folder_name,...void 0!==n.is_confidential?{is_confidential:n.is_confidential}:{},name:e.name,policy:{member_policy:n.policy.member_policy?{".tag":n.policy.member_policy}:void 0,resolved_member_policy:n.policy.resolved_member_policy?{".tag":n.policy.resolved_member_policy}:void 0,acl_update_policy:n.policy.acl_update_policy?{".tag":n.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:n.policy.shared_link_policy?{".tag":n.policy.shared_link_policy}:{".tag":"other"},viewer_info_policy:n.policy.viewer_info_policy?{".tag":n.policy.viewer_info_policy}:void 0},permissions:lt(e.permissions),members_cursor:e.members_cursor,owner_team_policies:ct(n.owner_team_policies),folder_id:n.folder_id}}{const i=e;return{".tag":"shared_folder",access_type:it(e.access_type),is_inside_team_folder:t,is_team_folder:a,owner_team:i.owner_team,parent_shared_folder_id:i.parent_shared_folder_id?String(i.parent_shared_folder_id):void 0,path_lower:i.path_lower,parent_folder_name:i.parent_folder_name,...void 0!==i.is_confidential?{is_confidential:i.is_confidential}:{},name:e.name,permissions:lt(e.permissions),policy:{member_policy:i.policy.member_policy?{".tag":i.policy.member_policy}:void 0,resolved_member_policy:i.policy.resolved_member_policy?{".tag":i.policy.resolved_member_policy}:void 0,acl_update_policy:i.policy.acl_update_policy?{".tag":i.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:i.policy.shared_link_policy?{".tag":i.policy.shared_link_policy}:{".tag":"other"},download_policy:i.policy.download_policy?{".tag":i.policy.download_policy}:{".tag":"other"},viewer_info_policy:i.policy.viewer_info_policy?{".tag":i.policy.viewer_info_policy}:void 0},preview_url:i.preview_url||"",shared_folder_id:i.shared_folder_id.toString(),time_invited:(null===(n=i.time_invited)||void 0===n?void 0:n.toString())||"",folder_size:i.folder_size,can_mount:i.can_mount,invite_info:i.invite_info,owner_team_policies:ct(i.owner_team_policies),is_encrypted:i.is_encrypted,folder_id:i.folder_id}}}{const t=e;return{".tag":"file",access_type:it(t.access_type),download_policy:{".tag":"other"},id:t.id,name:t.name,owner_team:t.owner_team,parent_shared_folder_id:t.parent_shared_folder_id?String(t.parent_shared_folder_id):void 0,path_display:t.path_display,path_lower:t.path_lower,permissions:dt(t.permissions),policy:{member_policy:(null===(i=t.policy)||void 0===i?void 0:i.member_policy)?{".tag":t.policy.member_policy}:void 0,resolved_member_policy:(null===(r=t.policy)||void 0===r?void 0:r.resolved_member_policy)?{".tag":t.policy.resolved_member_policy}:void 0,acl_update_policy:(null===(o=t.policy)||void 0===o?void 0:o.acl_update_policy)?{".tag":t.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:(null===(s=t.policy)||void 0===s?void 0:s.shared_link_policy)?{".tag":t.policy.shared_link_policy}:{".tag":"other"},download_policy:(null===(l=t.policy)||void 0===l?void 0:l.download_policy)?{".tag":t.policy.download_policy}:{".tag":"other"},viewer_info_policy:(null===(d=t.policy)||void 0===d?void 0:d.viewer_info_policy)?{".tag":t.policy.viewer_info_policy}:void 0},preview_url:t.preview_url||"",time_invited:null===(_=t.time_invited)||void 0===_?void 0:_.toString(),is_cloud_doc:t.is_cloud_doc,owner_team_policies:ct(t.owner_team_policies)}}},ct=e=>{if(e)return{shared_folder_member_policy:ut(e.shared_folder_member_policy),shared_folder_join_policy:mt(e.shared_folder_join_policy),shared_link_create_policy:gt(e.shared_link_create_policy),group_creation_policy:pt(e.group_creation_policy),shared_folder_link_restriction_policy:ft(e.shared_folder_link_restriction_policy),enforce_link_password_policy:ht(e.enforce_link_password_policy),default_link_expiration_days_policy:yt(e.default_link_expiration_days_policy),shared_link_default_permissions_policy:vt(e.shared_link_default_permissions_policy)}},ut=e=>{switch(e){case"team":return Ie;case"team_and_approved":return be;case"other":return ke;default:return Ae}},mt=e=>{switch(e){case"from_team_only":return Re;case"other":return Me;default:return Ne}},gt=e=>{switch(e){case"default_team_only":return Le;case"team_only":return xe;case"default_no_one":return Pe;case"other":return Oe;default:return Ce}},pt=e=>"admins_only"===e?Fe:De,ft=e=>{switch(e){case"members":return $e;case"other":return He;default:return Ue}},ht=e=>{switch(e){case"required":return qe;case"other":return Je;default:return Be}},yt=e=>{switch(e){case"day_1":return Ve;case"day_180":return je;case"day_3":return We;case"day_30":return Ge;case"day_7":return ze;case"day_90":return Ke;case"year_1":return Ze;case"other":return Qe;default:return Ye}},vt=e=>{switch(e){case"default":default:return Xe;case"edit":return et;case"view":return tt}},Et=e=>{switch(e){case a.LinkAudienceDisallowedReason.DeleteAndRecreate:return a.DISALLOWED_REASON_DELETE_AND_RECREATE;case a.LinkAudienceDisallowedReason.RestrictedBySharedFolder:return a.DISALLOWED_REASON_RESTRICTED_BY_SHARED_FOLDER;case a.LinkAudienceDisallowedReason.RestrictedByTeam:return a.DISALLOWED_REASON_RESTRICTED_BY_TEAM;case a.LinkAudienceDisallowedReason.UserAccountType:return a.DISALLOWED_REASON_USER_ACCOUNT_TYPE;case a.LinkAudienceDisallowedReason.UserNotOnTeam:return a.DISALLOWED_REASON_USER_NOT_ON_TEAM;case a.LinkAudienceDisallowedReason.PermissionDenied:return a.DISALLOWED_REASON_PERMISSION_DENIED;default:return}},Tt=e=>{if(void 0!==e)return e.map((e=>({audience:st(e.audience),allowed:e.allowed,disallowed_reason:Et(e.disallowed_reason)})))},St=e=>{switch(e){case"day_1":return ie;case"day_180":return re;case"day_3":return oe;case"day_30":return se;case"day_7":return le;case"day_90":return de;case"none":return _e;case"year_1":return ce;case"other":return ue;default:return}},wt=e=>{switch(e){case"allow":return me;case"not_allowed":return ge;case"other":return pe;default:return}},At=e=>{switch(e){case"optional":return fe;case"required":return he;case"other":return ye;default:return}},It=e=>({id:e.id,name:e.name}),bt=e=>{switch(e){case"admin_invite_expand_eligibility":return ve;case"member_suggestion_expand_eligibility":return Ee;case"member_invite_expand_eligibility":return Te;case"member_invite_partial_eligibility":return Se;default:return we}},kt=a.defineContext(""),Rt={".tag":"viewer"},Nt={".tag":"editor"};function Mt(e){return{class:"sharing_sender",action:"select",object:"flexible_sharing_entrypoint_action",properties:e}}const Ct=({teamName:e,parentFolderName:t,isRestoreAccessEnabled:n,onRestoreAccessClick:r,onBannerClose:o})=>{const l=i.useIntl(),d=M.useCallback((()=>{r(e)}),[e,r]),_=""!==t?l.formatMessage({id:"KG/fFv",defaultMessage:"This folder isn’t shared with everyone who has access to parent folder <b>{parent}</b>."},{parent:t,b:e=>M.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}):l.formatMessage({id:"kIOCH3",defaultMessage:"This folder isn’t shared with everyone on {team_name}."},{team_name:s.Emstring.em_snippet(e,a.SNIPPET_SIZES.DISPLAY_NAME)}),c=l.formatMessage({id:"96XDs/",defaultMessage:"Share with everyone"});return M.createElement(a.Banner,{withLeftIcon:M.createElement(a.UIIcon,{src:a.InfoLine}),withCloseButton:o?l.formatMessage({id:"R/Hjn0",defaultMessage:"Close"}):void 0,onRequestClose:o},M.createElement(a.Banner.Message,null,M.createElement(a.Text,null,_,n&&" ",n&&M.createElement(a.Button,{"aria-label":c,key:"restore access",variant:"transparent",size:"medium",onClick:d,style:{fontFamily:"var(--type__body__standard--fontfamily)",fontWeight:"var(--type__body__standard--fontweight_strong)",fontSize:"var(--type__body__standard--fontsize)",letterSpacing:0}},c))))};Ct.displayName="ConfidentialFolderSection";const Lt=e=>e.formatMessage({id:"RYuEPZ",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),xt=e=>e.formatMessage({id:"c7+ulZ",defaultMessage:"This email isn’t on your Dropbox team."}),Pt=e=>e.formatMessage({id:"Vp93jb",defaultMessage:"One or more of these emails is no longer active."}),Ot=e=>e.formatMessage({id:"Eowy6P",defaultMessage:"Automatic groups can only be added to team folders."}),Dt=e=>e.formatMessage({id:"LKdcDm",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),Ft=e=>e.formatMessage({id:"mvBmmQ",defaultMessage:"This email isn’t on your Dropbox team."}),$t=e=>e.formatMessage({id:"0IC8VF",defaultMessage:"You don’t have permission to share with some of these people."}),Ut=e=>e.formatMessage({id:"8tC+2X",defaultMessage:"Only groups can be added to team folders."}),Ht=e=>e.formatMessage({id:"UrkgWp",defaultMessage:"You don’t have permission to share with some of these people due to restrictions on their end."}),Bt=e=>e.formatMessage({id:"S+fqGv",defaultMessage:"One or more of the emails you entered are invalid."}),qt=e=>e.formatMessage({id:"KxgNgG",defaultMessage:"Add message (optional)"}),Jt=e=>e.formatMessage({id:"gO5KOr",defaultMessage:"Loading Dash summary..."}),Vt=e=>e.formatMessage({id:"30bVmM",defaultMessage:"Add a note"}),jt=e=>e.formatMessage({id:"Qd1iC2",defaultMessage:"Sharing..."}),Wt=(e,t)=>t?jt(e):(e=>e.formatMessage({id:"lHCrsZ",defaultMessage:"Share"}))(e),Gt=(e,t)=>"editor"===t[".tag"]?(e=>e.formatMessage({id:"J3CMt1",defaultMessage:"can edit"}))(e):(e=>e.formatMessage({id:"xOIBKS",defaultMessage:"can view"}))(e),zt=(e,t)=>e.formatMessage({id:"lvjqTm",defaultMessage:"Shared <st>{name}</st>."},{st:e=>M.createElement("strong",{key:a.getName(t)},e),name:s.Emstring.em_snippet(a.getName(t),a.SNIPPET_SIZES.FILENAME)}),Kt=e=>e.formatMessage({id:"nf2M+i",defaultMessage:"There was a problem completing this request."}),Yt=e=>e.formatMessage({id:"PbG9/M",defaultMessage:"You don’t have access to this content."}),Zt=e=>e.formatMessage({id:"ktVMZy",defaultMessage:"Your team settings don’t allow sharing outside your team."}),Qt=e=>e.formatMessage({id:"ccjg/d",defaultMessage:"You entered an invalid name or email address."}),Xt=e=>e.formatMessage({id:"KWUYO4",defaultMessage:"You’ve hit the limit of invites for today. Try again later."}),ea=e=>e.formatMessage({id:"CTRWVL",defaultMessage:"You don’t have permission to do this. Contact the owner."}),ta=e=>e.formatMessage({id:"xoQiJt",defaultMessage:"You haven’t verified your email. Check your email and try again."}),aa=e=>e.formatMessage({id:"kJSilf",defaultMessage:"Couldn’t share, but it might work if you reload the page and try again."}),na=e=>e.formatMessage({id:"A35Dw0",defaultMessage:"You need to upgrade your account to do this."}),ia=e=>e.formatMessage({id:"ebZyPl",defaultMessage:"You’re sharing with too many people."}),ra=e=>e.formatMessage({id:"Bcojaq",defaultMessage:"Contact support"}),oa=(e,t)=>e.formatMessage({id:"0UrAT5",defaultMessage:"Couldn’t create shared folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t}),sa=e=>e.formatMessage({id:"/sRvdA",defaultMessage:"Folder updates in progress — please try again later."}),la=(e,t,n)=>{const i=a.getName(n),r=a.getParentFolderName(n);return t?e.formatMessage({id:"5xCeTo",defaultMessage:"Removing members from <strong>{folderName}</strong>…"},{folderName:s.Emstring.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>M.createElement("strong",null,e)}):""===r?e.formatMessage({id:"90I244",defaultMessage:"Sharing <strong>{folderName}</strong> with everyone…"},{folderName:s.Emstring.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>M.createElement("strong",null,e)}):e.formatMessage({id:"16RnmU",defaultMessage:"Sharing <strong>{folderName}</strong> with members of <strong>{parentFolderName}</strong>…"},{folderName:s.Emstring.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:s.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>M.createElement("strong",null,e)})},da=(e,t)=>t?e.formatMessage({id:"1HgFQB",defaultMessage:"Couldn’t remove members. Try again."}):e.formatMessage({id:"ypun4U",defaultMessage:"Couldn’t share folder. Try sharing again."}),_a=e=>e.formatMessage({id:"b0sjjf",defaultMessage:"Learn more"}),ca=()=>{const e=ua();return M.useMemo((()=>(null==e?void 0:e.isLoading)?{isLoading:!0}:(null==e?void 0:e.error)?{isLoading:!1,isError:!0,error:e.error.appError}:{output:e.data.apiData,isLoading:!1,isError:!1}),[e])},ua=()=>a.sharingPrefsPackage.useQuery({},{staleTime:36e5});const ma=()=>{const e=i.useIntl();return M.default.createElement(a.Box,{style:{display:"flex",flexDirection:"column",height:"310px"}},M.default.createElement(_.ButtonWrapper,null,M.default.createElement(_.HorizontalButton,{disabled:!0},M.default.createElement(a.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),M.default.createElement(a.Skeleton.Text,{size:"large",width:200}))),M.default.createElement(a.Box,{style:{marginTop:"var(--dig-spacing__dimension__12)"}},M.default.createElement(a.StylelessButton,{disabled:!0,className:_.baseButton,style:{height:"190px",width:"100%",padding:"var(--dig-spacing__dimension__16)"}},M.default.createElement(a.Box,{style:{display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"flex-start",rowGap:"var(--dig-spacing__dimension__16)"}},M.default.createElement(a.Skeleton.Text,{width:330,style:{margin:0}}),M.default.createElement(a.Skeleton.Text,{width:330,style:{margin:0}}),M.default.createElement(a.Skeleton.Text,{width:330,style:{margin:0}}))),M.default.createElement(a.Box,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"var(--dig-spacing__dimension__12)"}},M.default.createElement(a.Skeleton.Text,{size:"large",width:200}),M.default.createElement(a.Button,{variant:"primary",size:"medium",fullWidth:!1,disabled:!0},Wt(e,!1)))))};ma.displayName="LoadingScreen";const ga=/^['#&A-Za-z0-9._%+-]+@[A-Za-z0-9-][A-Za-z0-9.-]*\.[A-Za-z]{2,15}$/,pa={$props:l.atom({oid:{".tag":"file",fileId:""},objectMetadataResult:{isLoading:!0},accountMetadataResult:{isLoading:!0},sharingPrefsResult:{isLoading:!0},inviteMessage:"",inviteTargets:[],hasUpdatedAccountMetadata:!1,onCloseClick:()=>{},onTargetsDropdownFocusChange:()=>{},onInviteMessageChange:()=>{},onInviteTargetsChange:()=>{},onShareStart:()=>{},onInbandShareSuccess:()=>{},onShareFailure:()=>{},onStartInband:()=>{},onRefreshObjectMetadata:()=>{},onRefreshModal:()=>{},onObjectIdentifierChanged:()=>Promise.resolve(),shouldStyleForSM21:!1,shouldTransitionAccessoryAreaEnter:!1,isConfidentialFolderBannerClosed:!1}),$inviteTargets:l.atom([]),$inviteMessage:l.atom(""),$inviteTargetValidations:l.atom({}),$isDataBeingUpdated:l.atom(!1),$isInviteSending:l.atom(!1),$shouldPostMessageAsComment:l.atom(!1),$isInviteMessageTooLong:l.atom(!1),$changeConfidentialityData:l.atom(null),$isSuggestionsOpen:l.atom(!1),$isProgressiveButtonHovered:l.atom(!1),$progressiveButtonHoverStartTime:l.atom(0),$componentViewTime:l.atom(0),$inviteTargetsWithValidEmails:l.atom([]),$inviteTargetsWithInvalidEmails:l.atom([]),$objectIdentifierId:l.atom(""),$sharingAccessLevel:l.atom(Rt),$canInviteViewer:l.atom(!1),$canInviteEditor:l.atom(!1),$isFolder:l.atom(!1),$isConfidentialFolder:l.atom(!1),$isNewFolder:l.atom(!1)},{StoreProvider:fa,useStore:ha}=l.defineStoreProvider((e=>{const t=l.proxy((()=>e.get().inviteMessage),(t=>e.get().onInviteMessageChange(t))),n=l.proxy((()=>e.get().inviteTargets),(t=>e.get().onInviteTargetsChange(t))),i=l.proxy((()=>n.get().filter((e=>"group"===e[".tag"]||ga.test(e.email))))),r=l.proxy((()=>n.get().filter((e=>"group"!==e[".tag"]&&!ga.test(e.email))))),o=l.atom({}),s=l.atom(!1),d=l.atom(!1),_=l.atom(!1),c=l.atom(!1),u=l.atom(null),m=l.atom(!1),g=l.atom(!1),p=l.atom(0),f=l.atom(0),h=l.atom(a.getContentIdOrPathFromObjectIdentifier(e.get().oid)),y=l.proxy((()=>{const t=e.get().sharingPrefsResult;return t.isLoading||t.isError?null:t.output})),v=l.proxy((()=>{const t=e.get().objectMetadataResult;return t.isLoading||t.isError?null:t.output})),E=l.proxy((()=>{const e=y.get(),t=v.get();return!(!e||!t)&&a.getCanInvite(t,Nt)})),T=l.proxy((()=>{const e=y.get(),t=v.get();return!(!e||!t)&&a.getCanInvite(t,Rt)})),S=l.proxy((()=>{const e=y.get();return e&&E.get()?(e=>{const t=e.default_sharing_access_level_setting;if(!t)return a.EDITOR;switch(t[".tag"]){case a.SharingAccessLevel.VIEW:return a.VIEWER;case a.SharingAccessLevel.UNKNOWN:case a.SharingAccessLevel.EDIT:default:return a.EDITOR}})(e):Rt})),w=l.atom(S.get()),A=l.proxy((()=>{const e=v.get();return!!e&&a.getIsFolder(e)})),I=l.proxy((()=>{const e=v.get();return!!e&&a.getIsConfidentialFolder(e)})),b=l.proxy((()=>{var t;return null!==(t=e.get().isNewFolder)&&void 0!==t&&t}));return{$props:e,$inviteMessage:t,$inviteTargets:n,$inviteTargetsWithInvalidEmails:r,$inviteTargetsWithValidEmails:i,$inviteTargetValidations:o,$isDataBeingUpdated:s,$isInviteSending:d,$shouldPostMessageAsComment:_,$isInviteMessageTooLong:c,$changeConfidentialityData:u,$isSuggestionsOpen:m,$isProgressiveButtonHovered:g,$progressiveButtonHoverStartTime:p,$componentViewTime:f,$objectIdentifierId:h,$sharingAccessLevel:w,$canInviteViewer:T,$canInviteEditor:E,$isFolder:A,$isConfidentialFolder:I,$isNewFolder:b}}),pa),ya=e=>{const t=s.useSharingObjectMetadata(e.oid.fileId),a=s.useSharingAccountInfo(),n=ca();return n.isLoading?M.createElement(ma,null):M.createElement(fa,{objectMetadataResult:t,accountMetadataResult:a,sharingPrefsResult:n,...e})};ya.displayName="Provider";const va="share-modal-evolution-access-level-dropdown",Ea=`${va}__audience-text`,Ta=`${va}__portaled-menu`,Sa=()=>{const e=i.useIntl(),t=ha(),n=l.useAtom(t.$sharingAccessLevel),r=l.useAtom(t.$isInviteSending),s=l.useAtom(t.$canInviteEditor),d=l.useAtom(t.$canInviteViewer),_=(s?1:0)+(d?1:0),c=(()=>{const e=o.useLogger(),t=ha(),a=l.useAtom(t.$sharingAccessLevel);return M.useCallback((n=>{e("SHARE_MODAL_SHARE__LINK_ACCESS_LEVEL__CHANGE",{previous:a,next:{".tag":n}}),t.$sharingAccessLevel.set({".tag":n})}),[t,e,a])})();return M.createElement(a.Box,{className:a.cx([`${va}`,_>1?`${va}__with-menu`:void 0]),borderRadius:"Small",style:{minWidth:"auto",display:"flex",whiteSpace:"pre-wrap",flexWrap:"wrap",alignItems:"center"},"data-testid":"access-level-dropdown"},M.createElement(a.Text,{className:Ea,"data-testid":"invite-audience",color:r?"disabled":"standard",size:"small"},(e=>e.formatMessage({id:"OGm4kF",defaultMessage:"People added"}))(e)," "),1===_?M.createElement(a.Text,{className:Ea,isBold:!0,size:"small",color:r?"disabled":"standard"},Gt(e,n)):M.createElement(a.Menu.Wrapper,{onSelection:c,style:{verticalAlign:"bottom",whiteSpace:"nowrap"},className:Ta},(({getContentProps:t,getTriggerProps:i})=>M.createElement(M.Fragment,null,M.createElement(a.Button,{...i(),variant:"transparent",withDropdownIcon:!0,size:"small",style:{marginTop:"1px",position:"relative"},disabled:r},Gt(e,n)),M.createElement(a.Menu.Content,{"data-sharing-sdk":"1",...t(),placement:"bottom-end"},M.createElement(a.Menu.Segment,null,d?M.createElement(a.Menu.SelectItem,{key:"view",value:"viewer",selected:"editor"!==n[".tag"]},M.createElement(a.Text,null,Gt(e,Rt))):null,s?M.createElement(a.Menu.SelectItem,{key:"edit",value:"editor",selected:"editor"===n[".tag"]},M.createElement(a.Text,null,Gt(e,Nt))):null))))))};Sa.displayName="AccessLevelDropdown";const wa=e=>e.reduce(((e,t)=>({[s.getUniqueId(t.member)]:t,...e})),{}),Aa=o.define({name:"sharing.validateTargets"},(e=>t=>o.handler(e.sharingTargetsValidate(t)))),Ia=e=>{const t=ha(),n=(e=>{const t=o.useEndpoint(Aa),n=o.useLogger(),i=ha();return M.useCallback((async()=>{const r=i.$inviteTargets.get();if(0===r.length)return void i.$inviteTargetValidations.set({});const o=i.$inviteTargetsWithInvalidEmails.get().reduce(((e,t)=>({...e,[W(t)]:{member:K(t),result:{".tag":"disallowed",disallowed:{".tag":"invalid_target"}},target_invite_eligibility:{".tag":"other"}}})),{});if(i.$inviteTargetValidations.set({...i.$inviteTargetValidations.get(),...o}),0===i.$inviteTargetsWithValidEmails.get().length)return;const l=Object.values(i.$inviteTargetValidations.get()).map((e=>e?s.getUniqueId(e.member):null)),d=i.$inviteTargetsWithValidEmails.get().filter((e=>{const t=s.getUniqueId(K(e));return!l.includes(t)}));if(0===d.length)return;const _=a.getIsFile(e)?"file":"folder",c=i.$objectIdentifierId.get();n("SHARE_MODAL_SHARE__PREVALIDATION__API_START",null);const u=await t({access_level:i.$sharingAccessLevel.get(),content_id:c,content_type:{".tag":_},members:d.map(K)});if("ERROR"===u.status)return void n("SHARE_MODAL_SHARE__PREVALIDATION__API_ERROR",{error:u.error});if("FATAL"===u.status)return void n("SHARE_MODAL_SHARE__PREVALIDATION__API_FATAL",{error:u.error});n("SHARE_MODAL_SHARE__PREVALIDATION__API_SUCCESS",null);const m=i.$inviteTargets.get(),g=i.$sharingAccessLevel.get(),p=e,f=a.getContentIdOrPathFromObjectIdentifier(i.$props.get().oid);r===m&&i.$sharingAccessLevel.get()===g&&c===f&&e===p&&i.$inviteTargetValidations.set({...i.$inviteTargetValidations.get(),...wa(u.output.results)})}),[i,t,n,e])})(e);M.useEffect((()=>{const e=[t.$inviteTargets.obs(n),t.$sharingAccessLevel.obs((()=>{n()})),t.$objectIdentifierId.obs((()=>{t.$inviteTargetValidations.set({}),n()}))];return t.$props.get().inviteTargets.length>0&&n(),()=>e.forEach((e=>e()))}),[])},ba=o.define({name:"sharing.addFileMember"},(e=>t=>o.handler(e.sharingAddFileMember(t)))),ka=o.define({name:"sharing.addFolderMember"},(e=>t=>o.handler(e.sharingAddFolderMemberV3(t))));function Ra(e){return{class:"sharing_sender",action:"initiate",object:"post_share_action",properties:e}}const Na=Symbol("ON_SHOW_ADMIN_INVITE_AFTER_SHARING_MODAL"),Ma=Symbol("ON_SHOW_MEMBER_INVITE_AFTER_SHARING_MODAL"),{useEmitter:Ca,defaultEmitter:La}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),r=t(a.Context$6),o=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(r),...a.getTags$7(o),isSm24:"true"};e.key!==Na?e.key!==Ma||a.UDCL.logEvent(Ra({postShareAction:"member_invite_after_sharing_modal",numInviteEligibleUsers:e.payload.numInviteEligibleUsers}),{tags:s}):a.UDCL.logEvent(Ra({postShareAction:"admin_invite_after_sharing_modal",numInviteEligibleUsers:e.payload.numInviteEligibleUsers}),{tags:s})}));class xa extends y.Message{constructor(e){super(),this.displayName="",this.dropboxBrandName="",this.dropboxBrandDisplayName="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new xa).fromBinary(e,t)}static fromJson(e,t){return(new xa).fromJson(e,t)}static fromJsonString(e,t){return(new xa).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(xa,e,t)}}var Pa,Oa,Da,Fa,$a,Ua;xa.runtime=y.proto3,xa.typeName="revenue_content.PlanName",xa.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"display_name",kind:"scalar",T:9},{no:2,name:"dropbox_brand_name",kind:"scalar",T:9},{no:3,name:"dropbox_brand_display_name",kind:"scalar",T:9}])),function(e){e[e.UNKNOWN_TYPE=0]="UNKNOWN_TYPE",e[e.PLAN=1]="PLAN",e[e.ADDON=2]="ADDON",e[e.LICENSE=3]="LICENSE",e[e.TRIAL=4]="TRIAL"}(Pa||(Pa={})),y.proto3.util.setEnumType(Pa,"multi_product_management.PlanType",[{no:0,name:"UNKNOWN_TYPE"},{no:1,name:"PLAN"},{no:2,name:"ADDON"},{no:3,name:"LICENSE"},{no:4,name:"TRIAL"}]),function(e){e[e.UNKNOWN_PURCHASE_TYPE=0]="UNKNOWN_PURCHASE_TYPE",e[e.DIRECT_PURCHASE=1]="DIRECT_PURCHASE",e[e.TRIAL_START_WITH_SCHEDULED_CONVERSION=2]="TRIAL_START_WITH_SCHEDULED_CONVERSION",e[e.TRIAL_START_WITHOUT_SCHEDULED_CONVERSION=3]="TRIAL_START_WITHOUT_SCHEDULED_CONVERSION",e[e.SCHEDULE_TRIAL_CONVERSION=4]="SCHEDULE_TRIAL_CONVERSION"}(Oa||(Oa={})),y.proto3.util.setEnumType(Oa,"multi_product_management.PurchaseType",[{no:0,name:"UNKNOWN_PURCHASE_TYPE"},{no:1,name:"DIRECT_PURCHASE"},{no:2,name:"TRIAL_START_WITH_SCHEDULED_CONVERSION"},{no:3,name:"TRIAL_START_WITHOUT_SCHEDULED_CONVERSION"},{no:4,name:"SCHEDULE_TRIAL_CONVERSION"}]),function(e){e[e.UNKNOWN_DISPLAY_MODE=0]="UNKNOWN_DISPLAY_MODE",e[e.STANDALONE=1]="STANDALONE",e[e.PORTABLE_IFRAME=2]="PORTABLE_IFRAME"}(Da||(Da={})),y.proto3.util.setEnumType(Da,"multi_product_management.DisplayMode",[{no:0,name:"UNKNOWN_DISPLAY_MODE"},{no:1,name:"STANDALONE"},{no:2,name:"PORTABLE_IFRAME"}]);class Ha extends y.Message{constructor(e){super(),this.purse20250324CheckoutParityTeamFssDpM1="",this.purse20250616CheckoutParityTeamTrialsM2="",this.purse20250616CheckoutParityTeamTrialsConversionM2="",this.purse20250623CheckoutParityIndividualTrialsM3="",this.purse20250623CheckoutParityIndividualDirectPurchaseM4="",this.max20251103TeamPaidTrials="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Ha).fromBinary(e,t)}static fromJson(e,t){return(new Ha).fromJson(e,t)}static fromJsonString(e,t){return(new Ha).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Ha,e,t)}}Ha.runtime=y.proto3,Ha.typeName="multi_product_management.MultiProductCheckoutExperimentProps",Ha.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"purse_2025_03_24_checkout_parity_team_fss_dp_m1",kind:"scalar",T:9},{no:2,name:"purse_2025_06_16_checkout_parity_team_trials_m2",kind:"scalar",T:9},{no:3,name:"purse_2025_06_16_checkout_parity_team_trials_conversion_m2",kind:"scalar",T:9},{no:4,name:"purse_2025_06_23_checkout_parity_individual_trials_m3",kind:"scalar",T:9},{no:5,name:"purse_2025_06_23_checkout_parity_individual_direct_purchase_m4",kind:"scalar",T:9},{no:6,name:"max_2025_11_03_team_paid_trials",kind:"scalar",T:9}]));class Ba extends y.Message{constructor(e){super(),this.products=[],this.layoutKey="",this.locale="",this.headerIcon="",this.headerLink="",this.hideTeamName=!1,this.defaultProductType=p.StorefrontPlatformProductType.UNKNOWN_PRODUCT_TYPE,this.hasActiveSubscriptions=!1,this.reusePaymentMethod=!1,this.showBirthdateSection=!1,this.showMemberAssignmentList=!1,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Ba).fromBinary(e,t)}static fromJson(e,t){return(new Ba).fromJson(e,t)}static fromJsonString(e,t){return(new Ba).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Ba,e,t)}}Ba.runtime=y.proto3,Ba.typeName="multi_product_management.MultiProductCheckoutPagePropsResponse",Ba.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"products",kind:"message",T:nn,repeated:!0},{no:2,name:"cart",kind:"message",T:on},{no:3,name:"encryption_options",kind:"message",T:a.EncryptionOptions},{no:4,name:"layout_key",kind:"scalar",T:9},{no:5,name:"locale",kind:"scalar",T:9},{no:6,name:"user_data",kind:"message",T:ln},{no:7,name:"header_icon",kind:"scalar",T:9},{no:8,name:"header_link",kind:"scalar",T:9},{no:9,name:"hide_team_name",kind:"scalar",T:8},{no:10,name:"experiments",kind:"message",T:Ha},{no:11,name:"sox_compliance_message",kind:"message",T:dn},{no:12,name:"default_product_type",kind:"enum",T:y.proto3.getEnumType(p.StorefrontPlatformProductType)},{no:13,name:"has_active_subscriptions",kind:"scalar",T:8},{no:14,name:"current_payment_method",kind:"message",T:f.CurrentPaymentMethod},{no:15,name:"reuse_payment_method",kind:"scalar",T:8},{no:16,name:"show_birthdate_section",kind:"scalar",T:8},{no:17,name:"show_member_assignment_list",kind:"scalar",T:8}]));class qa extends y.Message{constructor(e){super(),this.pricing=[],this.locale="",this.clientsideMessage="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new qa).fromBinary(e,t)}static fromJson(e,t){return(new qa).fromJson(e,t)}static fromJsonString(e,t){return(new qa).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(qa,e,t)}}qa.runtime=y.proto3,qa.typeName="multi_product_management.MultiProductCheckoutPagePricingPrefetchResponse",qa.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"pricing",kind:"message",T:Wa,repeated:!0},{no:2,name:"tax_info",kind:"message",T:h.TaxInfo},{no:3,name:"locale",kind:"scalar",T:9},{no:4,name:"clientside_message",kind:"scalar",T:9}]));class Ja extends y.Message{constructor(e){super(),this.members=[],y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Ja).fromBinary(e,t)}static fromJson(e,t){return(new Ja).fromJson(e,t)}static fromJsonString(e,t){return(new Ja).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Ja,e,t)}}Ja.runtime=y.proto3,Ja.typeName="multi_product_management.MultiProductCheckoutPageMemberInfoPrefetchResponse",Ja.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"members",kind:"message",T:cn,repeated:!0}]));class Va extends y.Message{constructor(e){super(),this.productType=p.StorefrontPlatformProductType.UNKNOWN_PRODUCT_TYPE,this.numLicenses=y.protoInt64.zero,this.discountPercentage="",this.promoProps=[],this.productCategory=p.StorefrontPlatformProductCategory.UNKNOWN_PRODUCT_CATEGORY,this.trialProjectType=h.StorefrontPlatformTrialsProjectType.UNKNOWN_PROJECT_TYPE,this.tags=[],this.addonPrices=[],y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Va).fromBinary(e,t)}static fromJson(e,t){return(new Va).fromJson(e,t)}static fromJsonString(e,t){return(new Va).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Va,e,t)}}Va.runtime=y.proto3,Va.typeName="multi_product_management.ProductDetailedPricing",Va.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"product_type",kind:"enum",T:y.proto3.getEnumType(p.StorefrontPlatformProductType)},{no:2,name:"billing_interval",kind:"message",T:p.ContractLength},{no:3,name:"num_licenses",kind:"scalar",T:3},{no:4,name:"price",kind:"message",T:h.CashAmount},{no:5,name:"tax_inclusive_price",kind:"message",T:h.CashAmount},{no:6,name:"per_user_price",kind:"message",T:h.CashAmount},{no:7,name:"tax_inclusive_per_user_price",kind:"message",T:h.CashAmount},{no:8,name:"discount_amount",kind:"message",T:h.CashAmount},{no:9,name:"discount_percentage",kind:"scalar",T:9},{no:10,name:"base_price",kind:"message",T:h.CashAmount},{no:11,name:"per_user_base_price",kind:"message",T:h.CashAmount},{no:12,name:"promo_props",kind:"message",T:h.PromoProps,repeated:!0},{no:13,name:"product_category",kind:"enum",T:y.proto3.getEnumType(p.StorefrontPlatformProductCategory)},{no:14,name:"trial_project_type",kind:"enum",T:y.proto3.getEnumType(h.StorefrontPlatformTrialsProjectType)},{no:15,name:"tags",kind:"scalar",T:9,repeated:!0},{no:16,name:"addon_prices",kind:"message",T:h.AddonPrice,repeated:!0}]));class ja extends y.Message{constructor(e){super(),this.currency="",this.taxCountryCode="",this.taxPlanName="",this.taxRate="",this.discountPercentage="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new ja).fromBinary(e,t)}static fromJson(e,t){return(new ja).fromJson(e,t)}static fromJsonString(e,t){return(new ja).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(ja,e,t)}}ja.runtime=y.proto3,ja.typeName="multi_product_management.OrderSummary",ja.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"sub_total_price",kind:"message",T:h.CashAmount},{no:2,name:"total_price",kind:"message",T:h.CashAmount},{no:3,name:"currency",kind:"scalar",T:9},{no:4,name:"tax_country_code",kind:"scalar",T:9},{no:5,name:"tax_amount",kind:"message",T:h.CashAmount},{no:6,name:"withheld_tax_amount",kind:"message",T:h.CashAmount},{no:7,name:"tax_plan_name",kind:"scalar",T:9},{no:8,name:"tax_rate",kind:"scalar",T:9},{no:9,name:"discount_amount",kind:"message",T:h.CashAmount},{no:10,name:"discount_percentage",kind:"scalar",T:9}]));class Wa extends y.Message{constructor(e){super(),this.pricingToken="",this.detailedPricing=[],this.purchaseType=Oa.UNKNOWN_PURCHASE_TYPE,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Wa).fromBinary(e,t)}static fromJson(e,t){return(new Wa).fromJson(e,t)}static fromJsonString(e,t){return(new Wa).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Wa,e,t)}}Wa.runtime=y.proto3,Wa.typeName="multi_product_management.PerIntervalPricing",Wa.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"pricing_token",kind:"scalar",T:9},{no:2,name:"detailed_pricing",kind:"message",T:Va,repeated:!0},{no:3,name:"order_summary",kind:"message",T:ja},{no:4,name:"trial_preview",kind:"message",T:h.StorefrontPlatformTrialStartPreview},{no:5,name:"purchase_type",kind:"enum",T:y.proto3.getEnumType(Oa)}]));class Ga extends y.Message{constructor(e){super(),this.scheduleId="",this.purchaseType=Oa.UNKNOWN_PURCHASE_TYPE,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Ga).fromBinary(e,t)}static fromJson(e,t){return(new Ga).fromJson(e,t)}static fromJsonString(e,t){return(new Ga).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Ga,e,t)}}Ga.runtime=y.proto3,Ga.typeName="multi_product_management.PerIntervalPurchase",Ga.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"purchase_product_info",kind:"message",T:h.PurchaseProductInfo},{no:2,name:"schedule_id",kind:"scalar",T:9},{no:3,name:"trial_preview",kind:"message",T:h.StorefrontPlatformTrialStartPreview},{no:4,name:"purchase_type",kind:"enum",T:y.proto3.getEnumType(Oa)}]));class za extends y.Message{constructor(e){super(),this.pricingToken="",this.purchaseProducts=[],y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new za).fromBinary(e,t)}static fromJson(e,t){return(new za).fromJson(e,t)}static fromJsonString(e,t){return(new za).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(za,e,t)}}za.runtime=y.proto3,za.typeName="multi_product_management.PerPricingPurchase",za.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"pricing_token",kind:"scalar",T:9},{no:2,name:"purchase_products",kind:"message",T:Ga,repeated:!0}]));class Ka extends y.Message{constructor(e){super(),this.isSuccess=!1,this.type="",this.errorType="",this.redirectUri="",this.threeDsErrorData="",this.paymentAuthType="",this.locale="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Ka).fromBinary(e,t)}static fromJson(e,t){return(new Ka).fromJson(e,t)}static fromJsonString(e,t){return(new Ka).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Ka,e,t)}}Ka.runtime=y.proto3,Ka.typeName="multi_product_management.CheckoutPurchaseResult",Ka.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"is_success",kind:"scalar",T:8},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"error_type",kind:"scalar",T:9},{no:4,name:"redirect_uri",kind:"scalar",T:9},{no:5,name:"three_ds_error_data",kind:"scalar",T:9},{no:6,name:"payment_auth_type",kind:"scalar",T:9},{no:7,name:"total_amount",kind:"message",T:h.CashAmount},{no:8,name:"locale",kind:"scalar",T:9}]));class Ya extends y.Message{constructor(e){super(),this.productType=p.StorefrontPlatformProductType.UNKNOWN_PRODUCT_TYPE,this.intervalTitle="",this.totalPriceFormatted="",this.pricePerLicenseFormatted="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Ya).fromBinary(e,t)}static fromJson(e,t){return(new Ya).fromJson(e,t)}static fromJsonString(e,t){return(new Ya).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Ya,e,t)}}Ya.runtime=y.proto3,Ya.typeName="multi_product_management.MarketingPricing",Ya.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"product_type",kind:"enum",T:y.proto3.getEnumType(p.StorefrontPlatformProductType)},{no:2,name:"billing_interval",kind:"message",T:p.ContractLength},{no:3,name:"interval_title",kind:"scalar",T:9},{no:4,name:"total_price",kind:"message",T:h.CashAmount},{no:5,name:"total_price_formatted",kind:"scalar",T:9},{no:6,name:"price_per_license",kind:"message",T:h.CashAmount},{no:7,name:"price_per_license_formatted",kind:"scalar",T:9}]));class Za extends y.Message{constructor(e){super(),this.defaultLicenseCount=0,this.minLicenseCount=0,this.maxLicenseCount=0,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Za).fromBinary(e,t)}static fromJson(e,t){return(new Za).fromJson(e,t)}static fromJsonString(e,t){return(new Za).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Za,e,t)}}Za.runtime=y.proto3,Za.typeName="multi_product_management.LicenseProps",Za.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"default_license_count",kind:"scalar",T:5},{no:2,name:"min_license_count",kind:"scalar",T:5},{no:3,name:"max_license_count",kind:"scalar",T:5}]));class Qa extends y.Message{constructor(e){super(),this.quotaText="",this.quotaCapGb=0,this.licenseQuotaGb=0,this.planQuotaBytes=y.protoInt64.zero,this.quotaTextShort="",this.trialQuotaText="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Qa).fromBinary(e,t)}static fromJson(e,t){return(new Qa).fromJson(e,t)}static fromJsonString(e,t){return(new Qa).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Qa,e,t)}}Qa.runtime=y.proto3,Qa.typeName="multi_product_management.QuotaInfo",Qa.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"quota_text",kind:"scalar",T:9},{no:2,name:"quota_cap_gb",kind:"scalar",T:5},{no:3,name:"license_quota_gb",kind:"scalar",T:5},{no:4,name:"plan_quota_bytes",kind:"scalar",T:3},{no:5,name:"quota_text_short",kind:"scalar",T:9},{no:6,name:"trial_quota_text",kind:"scalar",T:9}]));class Xa extends y.Message{constructor(e){super(),this.trialLink="",this.trialDuration=0,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new Xa).fromBinary(e,t)}static fromJson(e,t){return(new Xa).fromJson(e,t)}static fromJsonString(e,t){return(new Xa).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(Xa,e,t)}}Xa.runtime=y.proto3,Xa.typeName="multi_product_management.LinkedTrial",Xa.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"trial_link",kind:"scalar",T:9},{no:2,name:"trial_duration",kind:"scalar",T:5}]));class en extends y.Message{constructor(e){super(),this.text="",this.styleToken="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new en).fromBinary(e,t)}static fromJson(e,t){return(new en).fromJson(e,t)}static fromJsonString(e,t){return(new en).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(en,e,t)}}en.runtime=y.proto3,en.typeName="multi_product_management.StyledText",en.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"text",kind:"scalar",T:9},{no:2,name:"style_token",kind:"scalar",T:9}]));class tn extends y.Message{constructor(e){super(),this.additionalLegalMessages=[],this.trialStorageDisclaimers=[],this.paidStorageDisclaimers=[],y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new tn).fromBinary(e,t)}static fromJson(e,t){return(new tn).fromJson(e,t)}static fromJsonString(e,t){return(new tn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(tn,e,t)}}tn.runtime=y.proto3,tn.typeName="multi_product_management.ProductTextConfig",tn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"additional_legal_messages",kind:"scalar",T:9,repeated:!0},{no:2,name:"choose_plan_secondary_text",kind:"message",T:en},{no:3,name:"trial_storage_disclaimers",kind:"scalar",T:9,repeated:!0},{no:4,name:"paid_storage_disclaimers",kind:"scalar",T:9,repeated:!0}]));class an extends y.Message{constructor(e){super(),this.trialDuration=0,this.isPaidTrial=!1,this.projectType=h.StorefrontPlatformTrialsProjectType.UNKNOWN_PROJECT_TYPE,this.activeTrialEndTs=y.protoInt64.zero,this.isNoclickTrial=!1,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new an).fromBinary(e,t)}static fromJson(e,t){return(new an).fromJson(e,t)}static fromJsonString(e,t){return(new an).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(an,e,t)}}an.runtime=y.proto3,an.typeName="multi_product_management.TrialInfo",an.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"trial_duration",kind:"scalar",T:5},{no:2,name:"is_paid_trial",kind:"scalar",T:8},{no:3,name:"project_type",kind:"enum",T:y.proto3.getEnumType(h.StorefrontPlatformTrialsProjectType)},{no:4,name:"active_trial_end_ts",kind:"scalar",T:3},{no:5,name:"is_noclick_trial",kind:"scalar",T:8}]));class nn extends y.Message{constructor(e){super(),this.productType=p.StorefrontPlatformProductType.UNKNOWN_PRODUCT_TYPE,this.planType=Pa.UNKNOWN_TYPE,this.name="",this.description="",this.valuePropsList=[],this.ctaContent="",this.icon="",this.marketingPricingList=[],this.dependencyProduct="",this.intendedUserbaseText="",this.additionalLegalMessages=[],this.homeUrl="",this.productCategory=p.StorefrontPlatformProductCategory.UNKNOWN_PRODUCT_CATEGORY,this.allowedContractLengths=[],this.tryToBuyLink="",this.tags=[],this.addonList=[],y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new nn).fromBinary(e,t)}static fromJson(e,t){return(new nn).fromJson(e,t)}static fromJsonString(e,t){return(new nn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(nn,e,t)}}nn.runtime=y.proto3,nn.typeName="multi_product_management.Product",nn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"product_type",kind:"enum",T:y.proto3.getEnumType(p.StorefrontPlatformProductType)},{no:2,name:"plan_type",kind:"enum",T:y.proto3.getEnumType(Pa)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"description",kind:"scalar",T:9},{no:5,name:"value_props_list",kind:"scalar",T:9,repeated:!0},{no:6,name:"cta_content",kind:"scalar",T:9},{no:7,name:"icon",kind:"scalar",T:9},{no:8,name:"default_contract_length",kind:"message",T:p.ContractLength},{no:9,name:"marketing_pricing_list",kind:"message",T:Ya,repeated:!0},{no:10,name:"license_props",kind:"message",T:Za},{no:11,name:"dependency_product",kind:"scalar",T:9},{no:12,name:"intended_userbase_text",kind:"scalar",T:9},{no:13,name:"additional_legal_messages",kind:"scalar",T:9,repeated:!0},{no:14,name:"quota_info",kind:"message",T:Qa},{no:15,name:"linked_trial",kind:"message",T:Xa},{no:16,name:"home_url",kind:"scalar",T:9},{no:17,name:"text_config",kind:"message",T:tn},{no:18,name:"trial_info",kind:"message",T:an},{no:19,name:"product_category",kind:"enum",T:y.proto3.getEnumType(p.StorefrontPlatformProductCategory)},{no:20,name:"allowed_contract_lengths",kind:"message",T:p.ContractLength,repeated:!0},{no:21,name:"plan_name",kind:"message",T:xa},{no:22,name:"try_to_buy_link",kind:"scalar",T:9},{no:23,name:"tags",kind:"scalar",T:9,repeated:!0},{no:24,name:"addon_list",kind:"message",T:v.Addon,repeated:!0}]));class rn extends y.Message{constructor(e){super(),this.selectedLicenseCount=0,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new rn).fromBinary(e,t)}static fromJson(e,t){return(new rn).fromJson(e,t)}static fromJsonString(e,t){return(new rn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(rn,e,t)}}rn.runtime=y.proto3,rn.typeName="multi_product_management.ProductSelection",rn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"product",kind:"message",T:nn},{no:2,name:"selected_billing_interval",kind:"message",T:p.ContractLength},{no:3,name:"selected_license_count",kind:"scalar",T:5}]));class on extends y.Message{constructor(e){super(),this.selectedProductList=[],this.totalPriceFormatted="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new on).fromBinary(e,t)}static fromJson(e,t){return(new on).fromJson(e,t)}static fromJsonString(e,t){return(new on).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(on,e,t)}}on.runtime=y.proto3,on.typeName="multi_product_management.ShoppingCart",on.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"selected_product_list",kind:"message",T:rn,repeated:!0},{no:2,name:"tax_info",kind:"message",T:h.TaxInfo},{no:3,name:"total_price",kind:"message",T:h.CashAmount},{no:4,name:"total_price_formatted",kind:"scalar",T:9}]));class sn extends y.Message{constructor(e){super(),this.usageStatus="",this.usageBytes=y.protoInt64.zero,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new sn).fromBinary(e,t)}static fromJson(e,t){return(new sn).fromJson(e,t)}static fromJsonString(e,t){return(new sn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(sn,e,t)}}sn.runtime=y.proto3,sn.typeName="multi_product_management.UserQuotaData",sn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"storage_usage_data",kind:"message",T:E.StorageUsageData},{no:2,name:"usage_status",kind:"scalar",T:9},{no:3,name:"usage_bytes",kind:"scalar",T:3}]));class ln extends y.Message{constructor(e){super(),this.userId=y.protoInt64.zero,this.teamName="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new ln).fromBinary(e,t)}static fromJson(e,t){return(new ln).fromJson(e,t)}static fromJsonString(e,t){return(new ln).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(ln,e,t)}}ln.runtime=y.proto3,ln.typeName="multi_product_management.UserData",ln.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"user_id",kind:"scalar",T:3},{no:2,name:"quota_usage",kind:"message",T:sn},{no:3,name:"team_name",kind:"scalar",T:9}]));class dn extends y.Message{constructor(e){super(),this.title="",this.details="",this.detailsLink="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new dn).fromBinary(e,t)}static fromJson(e,t){return(new dn).fromJson(e,t)}static fromJsonString(e,t){return(new dn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(dn,e,t)}}dn.runtime=y.proto3,dn.typeName="multi_product_management.SoxComplianceMessage",dn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"title",kind:"scalar",T:9},{no:2,name:"domain",kind:"message",T:_n},{no:3,name:"details",kind:"scalar",T:9},{no:4,name:"details_link",kind:"scalar",T:9}]));class _n extends y.Message{constructor(e){super(),this.id="",this.example="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new _n).fromBinary(e,t)}static fromJson(e,t){return(new _n).fromJson(e,t)}static fromJsonString(e,t){return(new _n).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(_n,e,t)}}_n.runtime=y.proto3,_n.typeName="multi_product_management.DomainInfo",_n.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"example",kind:"scalar",T:9}]));class cn extends y.Message{constructor(e){super(),this.userId=y.protoInt64.zero,this.accountId="",this.displayName="",this.email="",this.accountPhotoUrl="",this.isCurrentUser=!1,this.isAdmin=!1,this.hasDash=!1,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new cn).fromBinary(e,t)}static fromJson(e,t){return(new cn).fromJson(e,t)}static fromJsonString(e,t){return(new cn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(cn,e,t)}}cn.runtime=y.proto3,cn.typeName="multi_product_management.MemberInfo",cn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"user_id",kind:"scalar",T:3},{no:2,name:"account_id",kind:"scalar",T:9},{no:3,name:"display_name",kind:"scalar",T:9},{no:4,name:"email",kind:"scalar",T:9},{no:5,name:"account_photo_url",kind:"scalar",T:9},{no:6,name:"is_current_user",kind:"scalar",T:8},{no:7,name:"is_admin",kind:"scalar",T:8},{no:8,name:"has_dash",kind:"scalar",T:8}])),t.DomainRestrictionState=void 0,(Fa=t.DomainRestrictionState||(t.DomainRestrictionState={}))[Fa.UNKNOWN=0]="UNKNOWN",Fa[Fa.NOT_RESTRICTED=1]="NOT_RESTRICTED",Fa[Fa.WARNING=2]="WARNING",Fa[Fa.CAPTURED=3]="CAPTURED",y.proto3.util.setEnumType(t.DomainRestrictionState,"js_init_data.domain_restriction.DomainRestrictionState",[{no:0,name:"UNKNOWN"},{no:1,name:"NOT_RESTRICTED"},{no:2,name:"WARNING"},{no:3,name:"CAPTURED"}]),function(e){e[e.ENROLLMENT_SOURCE_UNKNOWN=0]="ENROLLMENT_SOURCE_UNKNOWN",e[e.SIGNUP=1]="SIGNUP",e[e.RETROACTIVE=2]="RETROACTIVE"}($a||($a={})),y.proto3.util.setEnumType($a,"js_init_data.domain_restriction.EnrollmentSource",[{no:0,name:"ENROLLMENT_SOURCE_UNKNOWN"},{no:1,name:"SIGNUP"},{no:2,name:"RETROACTIVE"}]),t.ResolutionMethod=void 0,(Ua=t.ResolutionMethod||(t.ResolutionMethod={}))[Ua.RESOLUTION_METHOD_UNKNOWN=0]="RESOLUTION_METHOD_UNKNOWN",Ua[Ua.CHANGE_EMAIL=1]="CHANGE_EMAIL",Ua[Ua.JOIN_EXISTING_TEAM=2]="JOIN_EXISTING_TEAM",Ua[Ua.START_TRIAL=3]="START_TRIAL",Ua[Ua.PURCHASE_PLAN=4]="PURCHASE_PLAN",y.proto3.util.setEnumType(t.ResolutionMethod,"js_init_data.domain_restriction.ResolutionMethod",[{no:0,name:"RESOLUTION_METHOD_UNKNOWN"},{no:1,name:"CHANGE_EMAIL"},{no:2,name:"JOIN_EXISTING_TEAM"},{no:3,name:"START_TRIAL"},{no:4,name:"PURCHASE_PLAN"}]);class un extends y.Message{constructor(e){super(),this.unverifiedNewEmail="",y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new un).fromBinary(e,t)}static fromJson(e,t){return(new un).fromJson(e,t)}static fromJsonString(e,t){return(new un).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(un,e,t)}}un.runtime=y.proto3,un.typeName="js_init_data.domain_restriction.ChangeEmailMetadata",un.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"unverified_new_email",kind:"scalar",T:9}]));class mn extends y.Message{constructor(e){super(),this.discountPercent=0,this.minLicenses=0,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new mn).fromBinary(e,t)}static fromJson(e,t){return(new mn).fromJson(e,t)}static fromJsonString(e,t){return(new mn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(mn,e,t)}}mn.runtime=y.proto3,mn.typeName="js_init_data.domain_restriction.PromoBadge",mn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"discount_percent",kind:"scalar",T:5},{no:2,name:"min_licenses",kind:"scalar",T:5}]));class gn extends y.Message{constructor(e){super(),this.currentEmailDomain="",this.restrictionState=t.DomainRestrictionState.UNKNOWN,this.enrollmentSource=$a.ENROLLMENT_SOURCE_UNKNOWN,this.availableResolutionMethods=[],this.scheduledCaptureUtcMs=y.protoInt64.zero,this.experimentVariant="",this.includedTaxTypeText="",this.isEligible=!1,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new gn).fromBinary(e,t)}static fromJson(e,t){return(new gn).fromJson(e,t)}static fromJsonString(e,t){return(new gn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(gn,e,t)}}gn.runtime=y.proto3,gn.typeName="js_init_data.domain_restriction.AccountRestrictionResponse",gn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"current_email_domain",kind:"scalar",T:9},{no:2,name:"restriction_state",kind:"enum",T:y.proto3.getEnumType(t.DomainRestrictionState)},{no:3,name:"enrollment_source",kind:"enum",T:y.proto3.getEnumType($a)},{no:4,name:"available_resolution_methods",kind:"enum",T:y.proto3.getEnumType(t.ResolutionMethod),repeated:!0},{no:5,name:"scheduled_capture_utc_ms",kind:"scalar",T:3},{no:6,name:"change_email_metadata",kind:"message",T:un},{no:7,name:"product",kind:"message",T:nn},{no:8,name:"experiment_variant",kind:"scalar",T:9},{no:9,name:"promo_badge",kind:"message",T:mn},{no:10,name:"included_tax_type_text",kind:"scalar",T:9},{no:11,name:"is_eligible",kind:"scalar",T:8}]));class pn extends y.Message{constructor(e){super(),y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new pn).fromBinary(e,t)}static fromJson(e,t){return(new pn).fromJson(e,t)}static fromJsonString(e,t){return(new pn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(pn,e,t)}}pn.runtime=y.proto3,pn.typeName="js_init_data.domain_restriction.SetBypassTokenRequest",pn.fields=y.proto3.util.newFieldList((()=>[]));class fn extends y.Message{constructor(e){super(),this.success=!1,y.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new fn).fromBinary(e,t)}static fromJson(e,t){return(new fn).fromJson(e,t)}static fromJsonString(e,t){return(new fn).fromJsonString(e,t)}static equals(e,t){return y.proto3.util.equals(fn,e,t)}}fn.runtime=y.proto3,fn.typeName="js_init_data.domain_restriction.SetBypassTokenResponse",fn.fields=y.proto3.util.newFieldList((()=>[{no:1,name:"success",kind:"scalar",T:8}]));const hn={typeName:"domain_restriction.DomainRestrictionEdison",methods:{accountRestrictionRedirect:{name:"AccountRestrictionRedirect",I:a.EdisonRedirectArgs,O:a.EdisonRedirectResponse,kind:T.MethodKind.Unary},accountRestrictionPageConfig:{name:"AccountRestrictionPageConfig",I:a.EdisonPageConfigArgs,O:a.EdisonPageConfigResponse,kind:T.MethodKind.Unary},accountRestrictionPrefetch:{name:"AccountRestrictionPrefetch",I:g.PrefetchArgs,O:gn,kind:T.MethodKind.Unary},setBypassToken:{name:"SetBypassToken",I:pn,O:fn,kind:T.MethodKind.Unary}}},yn=["AccountRestrictionPrefetch"];async function vn(){return await g.Edison.fetch(hn,"AccountRestrictionPrefetch")}function En(e=!0){return d.useQuery(yn,vn,{staleTime:1/0,cacheTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,enabled:e})}const Tn=()=>{var n,i,r;const s=a.useGetContextValue(),{isNonUserRelativeContext:l}=a.useSharingApiContext(),d=Ca(),_=o.usePlatform()===o.Platforms.METASERVER,c=En(_),u=void 0===(null==(m=c.data)?void 0:m.restrictionState)||m.restrictionState===t.DomainRestrictionState.UNKNOWN?t.DomainRestrictionState.NOT_RESTRICTED:m.restrictionState;var m;const g=function(e){if(void 0!==(null==e?void 0:e.scheduledCaptureUtcMs))return Number(e.scheduledCaptureUtcMs)}(c.data),p=null===(n=c.data)||void 0===n?void 0:n.experimentVariant,f=null!==(r=null===(i=c.data)||void 0===i?void 0:i.isEligible)&&void 0!==r&&r,h=M.useRef(!1);return M.useCallback((async n=>{var i,r,c;if(n.sharingPrefs.should_reduce_upsells_churn_analysis)return;l||An(n.objectIdentifier,n.objectMetadata),n.user&&a.markMilestoneAsCompleted(n.user,o.ActivationTileMilestoneId.SHARE_CONTENT);const m=a.isNewApiMetadata(n.objectMetadata)?n.objectMetadata.common_metadata.path_display:n.objectMetadata.path_display,y=a.getIsFolder(n.objectMetadata),v={file_name:a.getName(n.objectMetadata),file_extension:a.getExtension$1(n.objectMetadata),file_path:m};y?a.publishEvent(a.CampaignEvents.FOLDER_IN_BAND_SHARE_SUCCESS,{context:{...v,is_team_folder:a.getIsInsideTeamFolderTree(n.objectMetadata)?"true":"false"}}):a.publishEvent(a.CampaignEvents.FILE_IN_BAND_SHARE_SUCCESS,{context:v});const E=null===(i=s(a.Context$4))||void 0===i?void 0:i.tiburonOrigin,T=null===(r=s(a.Context$4))||void 0===r?void 0:r.actionSurface;!T||"browse_screen"!==T&&"quick-view-browse"!==T&&"file_choose"!==T||a.trackUserLeapEvent(a.SharingUserLeapEvent.SM24_IB_SHARE_COMPLETE,E);const S=_&&(u===t.DomainRestrictionState.WARNING||u===t.DomainRestrictionState.CAPTURED);_&&p&&"OFF"!==p&&f&&!h.current&&(a.logExplicitExposure({growthbookVariantInfo:{feature:"member_expansion_2025_10_16_gating_teams_value_m1",variant:p}}),h.current=!0);const w=()=>{S&&async function(){const{asyncShowAccountResolutionModal:t}=await new Promise((function(t,a){e(["./c_teams_domain_restriction_account_resolution_modal_async"],t,a)}));return t}().then((e=>{e({onClose:()=>{},scheduledCaptureUtcMs:g,restrictionState:u,accountResolutionSurface:"modal",accountResolutionEntryPoint:"share_modal"})}))},{inviteEligibleNotSeenContacts:A,inviteEligibleSeenContacts:I,inviteEligibleSeenResurfaceContacts:b}=wn(n.inviteTargets,n.targetsValidateResult),k=q(A,I,b),R=null===(c=n.sharingPrefs.invite_after_sharing_modal_variant)||void 0===c?void 0:c[".tag"];let N=!1;if(R&&V(A,b,R))if(N=!0,"admin_invite_expand_eligibility"===R)if(1===k.length){const e=Date.now();Sn().then((t=>{d.select(Na).emit({numInviteEligibleUsers:k.length}),t({eligibleUsers:k,adminModalVariant:R,modalOrigin:E,modalLoadingStartTime:e})}))}else{const e=Date.now();Sn().then((t=>{d.select(Na).emit({numInviteEligibleUsers:k.length}),t({eligibleUsers:k,adminModalVariant:R,modalOrigin:E,modalLoadingStartTime:e})}))}else if(J(R)){const t=Date.now(),a=n.sharingPrefs.num_available_licenses;(async function(){const{showMemberInviteAfterSharingModal:t}=await new Promise((function(t,a){e(["./c_modals_invite_after_sharing_member_invite_after_sharing_modal"],t,a)}));return t})().then((e=>{d.select(Ma).emit({numInviteEligibleUsers:k.length}),e({eligibleUsers:k,memberModalVariant:R,sharingOrigin:E,modalLoadingStartTime:t,numAvailableLicenses:a})}))}N||w()}),[s,d,_,l,u,g,p,f])};async function Sn(){const{showAdminInviteAfterSharingModal:t}=await new Promise((function(t,a){e(["./c_modals_invite_after_sharing_admin_invite_after_sharing_modal"],t,a)}));return t}const wn=(e,t)=>{const a=Object.fromEntries(e.map((e=>[W(e),e]))),n=[],i=[],r=[];for(const e of t.results){const t=s.getUniqueId(e.member);a.hasOwnProperty(t)&&("eligible_not_seen"===e.target_invite_eligibility[".tag"]?n.push(a[t]):"eligible_seen"===e.target_invite_eligibility[".tag"]?i.push(a[t]):"eligible_seen_resurface"===e.target_invite_eligibility[".tag"]&&r.push(a[t]))}return{inviteEligibleNotSeenContacts:n.map((e=>at(e))),inviteEligibleSeenContacts:i.map((e=>at(e))),inviteEligibleSeenResurfaceContacts:r.map((e=>at(e)))}},An=(e,t)=>{if(a.getIsFile(t)){const t=[a.getContentIdOrPathFromObjectIdentifier(e)];a.getStoreForSharedWith().dispatch(a.sharedFileDataOutOfDate(t))}else a.getStoreForSharedWith().dispatch(a.sharedFolderDataOutOfDate())},In=["access_denied","path","not_found","email_not_verified","settings_error","not_authorized","undefined_error","banned_member","failed_copy_to_clipboard","invalid_logged_out_cookie","internal_error","other","contacts_error","rate_limit","bad_member","access_error","cant_share_outside_team","no_permission","too_many_invitees","invalid_csrf_token","invalid","user_not_logged_in","too_many_files","total_mounts_exceeded","home_mounts_exceeded","tree_size_exceeded","invalid_shared_folder","invalid_comment","team_policy_disallows_member_policy","disallowed_shared_link_policy","insufficient_plan","invalid_email","network","team_folder","too_many_members","too_many_pending_invites","already_shared"];function bn(e){return In.find((t=>t===(null==e?void 0:e.toLowerCase())))}const kn=Symbol("ON_IMMEDIATE_TRANSITION"),Rn=Symbol("ON_INVITE__START"),Nn=Symbol("ON_ADD_FILE_MEMBER_API_ERROR"),Mn=Symbol("ON_ADD_FILE_MEMBER_API_FATAL"),Cn=Symbol("ON_ADD_FILE_MEMBER_API_SUCCESS"),Ln=Symbol("ON_SHARE_FILE_FOLDER_FAILURE"),xn=Symbol("ON_SHARE_FILE_FOLDER_FAILURE_CONTINUE"),Pn=Symbol("ON_ADD_FOLDER_MEMBER_API_ERROR"),On=Symbol("ON_ADD_FOLDER_MEMBER_API_FATAL"),Dn=Symbol("ON_ADD_FOLDER_MEMBER_API_SUCCESS"),Fn=Symbol("ON_BEFORE_UNLOAD_DURING_INVITE"),$n=Symbol("ON_UNLOAD_DURING_INVITE"),{useEmitter:Un,defaultEmitter:Hn}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),r=t(a.Context$6),o=a.getShareModalTypeFromString("sm24"),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(r)};if(e.key!==Rn)if(e.key!==Cn&&e.key!==Dn){if(e.key===Mn||e.key===On)return a.UDCL.logEnd(S.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:"network",fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:l.screen}),{tags:{...s,errorReason:"network"},eventState:"failed",key:e.payload.actionKey}),void(Date.now()-e.payload.startTime>11e4&&a.UDCL.logEvent("ops.inband.likely_api_timeout",{tags:s}));if(e.key===Ln){const t=bn(S.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return a.UDCL.logEnd(S.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:l.screen}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void a.UDCL.logEvent("ops.sm24.share_file_folder_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key!==xn){if(e.key===Pn){const t=bn(S.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return a.UDCL.logEnd(S.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:l.screen}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void a.UDCL.logEvent("ops.sm24.add_folder_member_api_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key===Nn){const t=bn(S.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return a.UDCL.logEnd(S.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:l.screen}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void a.UDCL.logEvent("ops.sm24.add_file_member_api_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key!==kn)if(e.key!==Fn){if(e.key!==$n)return a.exhausts(e,void 0);a.UDCL.logEnd(S.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,fromNotifyInherited:!1,eventState:"canceled",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:l.screen}),{tags:{...s,errorReason:"navigation"},eventState:"canceled",key:e.payload.actionKey})}else{const t=Date.now()-e.payload.startTime,n=Math.round(1e4*t)/1e4;a.UDCL.logEvent("ops.inband.before_unload_during_invite",{tags:{...s,timeBucket:n.toString()}})}else a.UDCL.logEvent(Mt({...l,flexibleSharingEntryPointAction:"inband_immediate",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"inband_immediate"}})}else a.UDCL.logEvent("ops.sm24.share_file_folder_failure",{tags:{...s,errorReason:e.payload.error}})}else a.UDCL.logEnd(S.PAP_Send_ShareInvite({validationTraceId:void 0,numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,fromNotifyInherited:!1,sckeySha1:e.payload.sckeySha1,eventState:"success",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:l.screen}),{tags:s,eventState:"success",key:e.payload.actionKey});else a.UDCL.logStart(S.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,fromNotifyInherited:!1,shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:l.screen}),{tags:s,key:e.payload.actionKey})})),Bn=e=>{const t=ha(),n=l.useAtom(t.$inviteTargets),r=l.useAtom(t.$inviteTargetValidations),s=i.useIntl(),d=o.useLogger();return M.useMemo((()=>{let t=null;const i=Object.values(r).reduce(((e,t)=>"allowed"===t.result[".tag"]&&"outside_of_team"===t.result.allowed[".tag"]||"disallowed"===t.result[".tag"]&&"outside_of_team"===t.result.disallowed[".tag"]?e+1:e),0);for(const o of n){const n=W(o),l=r[n];if(l)if("disallowed"===l.result[".tag"]){const n=l.result.disallowed[".tag"];if("invalid_target"===n){t={level:"error",message:Bt(s)};break}if("invalid_member"===n){if("group"===o[".tag"]){t={level:"error",message:Ot(s)};break}t={level:"error",message:Pt(s)};break}"outside_of_team"===n?t={level:"error",message:i>1?Dt(s):Ft(s)}:"no_permission"===n?t=e&&a.getIsCollection(e)&&"group"===o[".tag"]?{level:"error",message:s.formatMessage({id:"vLSoUY",defaultMessage:"Collection sharing for groups is currently not supported"})}:{level:"error",message:$t(s)}:"target_is_individual"===n?t={level:"error",message:Ut(s)}:"target_not_same_team_restricted"===n?t={level:"error",message:Ht(s)}:(d("SHARE_MODAL_SHARE__PREVALIDATION__UNKNOWN_TAG",{value:n}),t={level:"error",message:Bt(s)})}else if(!t&&"allowed"===l.result[".tag"]){const e=l.result.allowed[".tag"];if("no_warning"===e)continue;"outside_of_team"===e?t=t||{level:"warn",message:i>1?Lt(s):xt(s)}:d("SHARE_MODAL_SHARE__PREVALIDATION__UNKNOWN_TAG",{value:e})}}return t}),[d,s,n,r,e])},qn=(e,t)=>{const n=ha(),r=i.useIntl(),d=s.useShowSharingNotifcation(),_=o.useLogger(),u=o.usePlatform(),m=o.useEndpoint(ba),g=o.useEndpoint(ka),p=o.useEndpoint(Aa),f=s.useAction(s.action$1),h=(()=>{const e=i.useIntl(),t=s.useShowSharingNotifcation();return M.useCallback((a=>"access_error"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Yt(e)}),a.error[".tag"]):"user_error"===a.error[".tag"]&&"email_unverified"===a.error.user_error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:ta(e)}),a.error.user_error[".tag"]):"invalid_comment"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Kt(e)}),a.error[".tag"]):"rate_limit"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Xt(e)}),a.error[".tag"]):(a.error[".tag"],t({type:s.SharingNotificationType.FAILURE,message:Kt(e)}),a.error[".tag"])),[e,t])})(),y=(()=>{const e=i.useIntl(),t=s.useShowSharingNotifcation();return M.useCallback((a=>"NetworkFailure"!==a.type&&"PollingNetworkFailure"!==a.type||429!==a.value.response.statusCode?"ApiError"===a.type&&"email_unverified"===a.value.response.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:ta(e)}),a.value.response.error[".tag"]):"ApiError"===a.type&&"no_permission"===a.value.response.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:ea(e)}),a.value.response.error[".tag"]):"ApiError"!==a.type||"too_many_mounts"!==a.value.response.error[".tag"]||"tree_size_exceeded"!==a.value.response.error.too_many_mounts[".tag"]&&"home_mounts_exceeded"!==a.value.response.error.too_many_mounts[".tag"]&&"total_mounts_exceeded"!==a.value.response.error.too_many_mounts[".tag"]?"ApiError"===a.type&&"bad_path"===a.value.response.error[".tag"]&&"already_shared"===a.value.response.error.bad_path[".tag"]?a.value.response.error.bad_path[".tag"]:"PollingApiError"===a.type&&"internal_error"===a.value.response.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE_WITH_HELP,message:aa(e),helpUrl:"/support",helpMessage:ra(e)}),a.value.response.error[".tag"]):(t({type:s.SharingNotificationType.FAILURE,message:Kt(e)}),"PollingTimeout"===a.type?"network":"PollingFailed"===a.type?"failed":"ApiError"===a.type||"PollingApiError"===a.type?a.value.response.error[".tag"]:"undefined"):(t({type:s.SharingNotificationType.FAILURE_WITH_HELP,message:oa(e,a.value.response.error.too_many_mounts.limit-a.value.response.error.too_many_mounts.current_count),helpMessage:_a(e),helpUrl:"https://help.dropbox.com/files-folders/share/shared-folder-faq#cantcreate"}),a.value.response.error.too_many_mounts[".tag"]):(t({type:s.SharingNotificationType.FAILURE_WITH_HELP,message:sa(e),helpUrl:"/help/9259"}),"network")),[e,t])})(),v=(()=>{const e=i.useIntl(),t=s.useShowSharingNotifcation();return M.useCallback((a=>"access_error"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Yt(e)}),a.error[".tag"]):"email_unverified"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:ta(e)}),a.error[".tag"]):"bad_member"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Qt(e)}),a.error[".tag"]):"cant_share_outside_team"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Zt(e)}),a.error[".tag"]):"too_many_members"===a.error[".tag"]||"too_many_pending_invites"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:ia(e)}),a.error[".tag"]):"insufficient_plan"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:na(e)}),a.error[".tag"]):"team_folder"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Zt(e)}),a.error[".tag"]):"no_permission"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:ea(e)}),a.error[".tag"]):"rate_limit"===a.error[".tag"]?(t({type:s.SharingNotificationType.FAILURE,message:Xt(e)}),a.error[".tag"]):(t({type:s.SharingNotificationType.FAILURE,message:Kt(e)}),a.error[".tag"])),[e,t])})(),E=Un(),{user:T}=a.useActiveUser(),S=Tn(),w=l.useAtom(n.$sharingAccessLevel),A=Bn(e),{oid:I,onShareStart:b,onShareFailure:k,onInbandShareSuccess:R,onObjectIdentifierChanged:N}=l.useAtom(n.$props),{getVisitorData:C}=c.useAbuseFpjsContext();return M.useCallback((async()=>{if(n.$isInviteSending.get())return;const i=n.$inviteTargets.get(),l=w[".tag"],c=n.$isNewFolder.get();let M=I;const L={numRecipients:i.length,accessLevel:"viewer"===l?"view":"edit",actionKey:Math.random().toString(),isNewFolder:c,startTime:Date.now()};if(_("SHARE_MODAL_SHARE__INVITE__START",null),E.select(Rn).emit(L),b(null),n.$isInviteSending.set(!0),n.$inviteTargetsWithInvalidEmails.get().length>0)return;_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_START",null);const x=a.getContentIdOrPathFromObjectIdentifier(I),P=await p({members:n.$inviteTargetsWithValidEmails.get().map(K),content_type:{".tag":"file"===I[".tag"]?"file":"file_folder"===I[".tag"]?"folder":"shared_folder"},access_level:{".tag":l},content_id:x});if("ERROR"===P.status&&_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_ERROR",{error:P.error}),"FATAL"===P.status&&_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_FATAL",{error:P.error}),"SUCCESS"===P.status&&(_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_SUCCESS",null),n.$inviteTargetValidations.set(wa(P.output.results))),A&&"error"===A.level)return _("SHARE_MODAL_SHARE__INVITE__CANCELLED",null),void n.$isInviteSending.set(!1);const O=e=>(_("SHARE_MODAL_SHARE__INVITE__NAVIGATE_ATTEMPT",null),E.select(Fn).emit(L),e.preventDefault(),e.returnValue="",""),D=()=>{_("SHARE_MODAL_SHARE__INVITE__NAVIGATE_AWAY",null),E.select($n).emit(L)};n.$props.get().onShareStart(null),window.addEventListener("beforeunload",O),window.addEventListener("unload",D);const F=()=>{n.$isInviteSending.set(!1),window.removeEventListener("beforeunload",O),window.removeEventListener("unload",D),k(null)},$=n.$props.get().inviteMessage,U=n.$shouldPostMessageAsComment.get(),H=(null==T?void 0:T.email)||"";if("file"===I[".tag"]){const e=await C("INBAND_SHARE_MODAL_FILE",H);_("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_START",null);const t=await m({access_level:{".tag":l},file:x,members:i.map(K),custom_message:$,add_message_as_comment:U&&$.length>0,fp_sealed_result:e.sealedResult});if("ERROR"===t.status){_("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_ERROR",{response:t});const e=h(t);return E.select(Nn).emit({...L,error:e}),void F()}if("FATAL"===t.status)return _("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_FATAL",{response:t}),E.select(Mn).emit(L),F(),void d({type:s.SharingNotificationType.FAILURE_WITH_HELP,message:aa(r),helpUrl:"/support",helpMessage:ra(r)});a.invalidateObjectMembers(I),_("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_SUCCESS",{response:t});const n=t.output[0]&&t.output[0].sckey_sha1&&t.output[0].sckey_sha1;E.select(Cn).emit({...L,sckeySha1:n})}if("file_folder"===I[".tag"]||"shared_folder"===I[".tag"]||"collection"===I[".tag"]){let t="file_folder"===I[".tag"]?"":"collection"===I[".tag"]?I.nsId:I.sharedFolderId;if("file_folder"===I[".tag"]){_("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__START",null);const n=await f({path:I.path,timeout:12e4,interval:1e3});if(n.success){t=n.value.response.output.shared_folder_id;const e=n.value.response.output.folder_id;u===o.Platforms.DESKTOP&&(M={".tag":"shared_folder",sharedFolderId:t,fileId:e})}else{if("ApiError"!==n.type||"bad_path"!==n.value.response.error[".tag"]||"already_shared"!==n.value.response.error.bad_path[".tag"]){F(),_("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__FAILURE",{output:n});const e=y(n);return void E.select(Ln).emit({...L,error:e})}{t=n.value.response.error.bad_path.shared_folder_id;const e=n.value.response.error.bad_path.folder_id;u===o.Platforms.DESKTOP&&(M={".tag":"shared_folder",sharedFolderId:t,fileId:e});const a=y(n);E.select(xn).emit({...L,error:a})}}_("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__SUCCESS",null),await s.invalidateSharingObjectMetadata(M),a.isNewApiMetadata(e)&&await s.invalidateNewApiObjectMetadata(M)}const n=await C("INBAND_SHARE_MODAL_FOLDER",H);_("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_START",null);const c=await g({shared_folder_id:t,...{...$?{custom_message:$}:{}},members:i.map((e=>({access_level:{".tag":l},member:K(e)}))),fp_sealed_result:n.sealedResult});if("ERROR"===c.status){_("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_ERROR",{response:c});const e=v(c);return E.select(Pn).emit({...L,error:e}),void F()}if("FATAL"===c.status)return _("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_FATAL",{response:c}),E.select(On).emit(L),F(),void d({type:s.SharingNotificationType.FAILURE,message:aa(r)});_("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_SUCCESS",{response:c}),M={".tag":"shared_folder",sharedFolderId:t,fileId:I.fileId},await a.invalidateObjectMembers(M),await s.invalidateSharingObjectMetadata(M),await s.invalidateNewApiObjectMetadata(M);const m=void 0;E.select(Dn).emit({...L,sckeySha1:m})}n.$isInviteSending.set(!1),window.removeEventListener("beforeunload",O),window.removeEventListener("unload",D),d({type:s.SharingNotificationType.COMPLETED,message:zt(r,e)}),M&&await(null==N?void 0:N(M)),R(),"SUCCESS"===P.status&&(n.$props.get().shouldDisablePostInbandShareHooks||S({objectMetadata:e,objectIdentifier:I,inviteTargets:i,targetsValidateResult:P.output,sharingPrefs:t,user:T}))}),[n,w,_,E,b,I,p,A,T,d,r,e,R,k,C,m,h,g,f,u,y,v,N,S,t])},Jn=e=>{const t=i.useIntl(),n=o.useLogger(),r=ha(),d=s.useShowSharingNotifcation(),{onRefreshModal:_,onRefreshObjectMetadata:c}=l.useAtom(r.$props);return M.useCallback((async(i,r,o,l,u=!1)=>{u?await _():await c();const m=((e,t,n)=>{const i=a.getName(n),r=a.getParentFolderName(n);return t?e.formatMessage({id:"7POTZF",defaultMessage:"Members removed from <strong>{folderName}</strong>."},{folderName:s.Emstring.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>M.createElement("strong",null,e)}):void 0===r||""===r?e.formatMessage({id:"nni9pE",defaultMessage:"<strong>{folderName}</strong> shared with everyone."},{folderName:s.Emstring.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>M.createElement("strong",null,e)}):e.formatMessage({id:"qvP8A+",defaultMessage:"<strong>{folderName}</strong> shared with members of <strong>{parentFolderName}</strong>."},{folderName:s.Emstring.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:s.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>M.createElement("strong",null,e)})})(t,r,e);d(o?{type:s.SharingNotificationType.COMPLETED_WITH_UNDO,message:m,undoOnClick:()=>null==l?void 0:l(i)}:{type:s.SharingNotificationType.COMPLETED,message:m}),n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_CONFIDENTIALITY__FINISH",null)}),[t,d,n,e,_,c])},Vn=e=>{const t=ha(),{oid:n}=l.useAtom(t.$props),r=(e=>{const t=i.useIntl(),n=s.useShowSharingNotifcation(),r=ha(),d=o.useLogger(),{onObjectIdentifierChanged:_}=l.useAtom(r.$props),c=s.useAction(s.action),u=s.useAction(s.action$1),m=Jn(e);return M.useCallback((async(i,r,o,l)=>{if("shared_folder"!==i[".tag"]&&"file_folder"!==i[".tag"])return;d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_CONFIDENTIALITY__START",null),n({type:s.SharingNotificationType.IN_PROGRESS,message:la(t,r,e)});let g=i;if("file_folder"===g[".tag"]){d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_START",null);const c=await u({path:g.path,confidentiality:r?{".tag":"confidential"}:{".tag":"not_confidential"},timeout:12e4,interval:1e3});if(c.success)return d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null),g={".tag":"shared_folder",sharedFolderId:c.value.response.output.shared_folder_id,fileId:i.fileId},await(null==_?void 0:_(g)),a.isNewApiMetadata(e)&&await s.invalidateNewApiObjectMetadata(i),m(g,r,o,l),void a.invalidateObjectMembers(g);if("ApiError"!==c.type||"bad_path"!==c.value.response.error[".tag"]||"already_shared"!==c.value.response.error.bad_path[".tag"])return d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_FAILURE",null),void n({type:s.SharingNotificationType.FAILURE,message:da(t,r)});d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null),g={".tag":"shared_folder",sharedFolderId:c.value.response.error.bad_path.shared_folder_id,fileId:i.fileId},await(null==_?void 0:_(g)),a.isNewApiMetadata(e)&&await s.invalidateNewApiObjectMetadata(i),d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null)}if(d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_START",null),!(await c({setAccessInheritanceArg:{access_inheritance:r?{".tag":"no_inherit"}:{".tag":"inherit"},shared_folder_id:g.sharedFolderId},timeout:12e4,interval:1e3})).success)return d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_FAILURE",null),void n({type:s.SharingNotificationType.FAILURE,message:da(t,r)});d("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_SUCCESS",null),m(g,r,o,l,!0),a.invalidateObjectMembers(g)}),[t,n,d,e,m,c,u,_])})(e);return M.useCallback((async e=>r(n,e,!0,(async t=>r(t,!e,!1)))),[n,r])},jn=(e,t,n)=>n?((e,t)=>e.formatMessage({id:"6jTcuT",defaultMessage:"Share with {teamName}"},{teamName:s.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,t):(e=>e.formatMessage({id:"P5jM9e",defaultMessage:"Share"}))(e),Wn=(e,t,n,i,r)=>r?((e,t,n)=>e.formatMessage({id:"ipUgQi",defaultMessage:"Share <b>{folderName}</b> with everyone at {teamName}?"},{folderName:s.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),teamName:s.Emstring.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>M.createElement("b",{style:{fontWeight:"var(--type__title__standard--fontweight_strong)"}},e)}))(e,n,t):((e,t,n)=>e.formatMessage({id:"znRNbl",defaultMessage:"Share <b>{folderName}</b> with everyone who can access <b>{parentFolderName}</b>?"},{folderName:s.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:s.Emstring.em_snippet(n,a.SNIPPET_SIZES.FOLDER_NAME),b:e=>M.createElement("b",{style:{fontWeight:"var(--type__title__standard--fontweight_strong)"}},e)}))(e,n,i),Gn=(e,t,a,n,i)=>i?((e,t,a)=>e.formatMessage({id:"R8xJiq",defaultMessage:"<b>{folderName}</b> won’t be shared privately any more. Everyone at {teamName} will have access to this folder."},{folderName:t,teamName:a,b:e=>M.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}))(e,a,t):((e,t)=>e.formatMessage({id:"ioGEl6",defaultMessage:"Everyone who can access <b>{parentFolderName}</b> will be able to access this folder."},{parentFolderName:t,b:e=>M.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}))(e,n),zn=({objectMetadata:e})=>{const t=i.useIntl(),n=ha(),r=l.useAtom(n.$changeConfidentialityData),o=(()=>{const e=ha();return M.useCallback((()=>{e.$changeConfidentialityData.set(null)}),[e])})(),s=Vn(e);if(!r)return null;const d=a.getName(e),_=a.getParentFolderName(e),c=""===_,u=jn(t,r.teamName,c),m=Wn(t,r.teamName,d,_,c),g=Gn(t,r.teamName,d,_,c);return M.createElement(M.Fragment,null,M.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:"Close",onRequestClose:o},M.createElement(a.Modal.Header,{"data-sharing-sdk":"1",hasBottomSpacing:"title-standard"},M.createElement(a.Modal.Title,null,m)),M.createElement(a.Modal.Body,{"data-sharing-sdk":"1"},g),M.createElement(a.Modal.Footer,{"data-sharing-sdk":"1"},M.createElement(a.Button,{variant:"opacity",onClick:o},(e=>e.formatMessage({id:"i3tRYX",defaultMessage:"Cancel"}))(t)),M.createElement(a.Button,{variant:"primary",onClick:()=>{s(!1),o()}},u))))};zn.displayName="ChangeConfidentialityModal";const Kn=({message:e,variant:t})=>{if(!e)return null;const n="error"===t?"alert":"attention";return M.createElement(a.Banner,{type:n},M.createElement(a.Banner.Message,{className:"scl-sharing-modal-validation-warning__message"},e))};Kn.displayName="FormValidationMessage";const Yn=e=>{w.reportException({err:e,severity:w.SEVERITY.NONCRITICAL,tags:["desktop-discovery","ai-sharing-summary"]})},Zn=()=>{var e,t,n;const i=(()=>{const{variant:e,error:t}=a.useExperimentVariant("bridge_growth_sharing_email_ai_summary");return t?(Yn(t),"OFF"):null!=e?e:"OFF"})(),{data:r,isLoading:o}=(()=>{try{return a.useDashAccess()}catch(e){return Yn(e),{data:void 0,isLoading:!1}}})(),s=null!==(n=null===(t=null===(e=null==r?void 0:r.apiData)||void 0===e?void 0:e.feature_attributes)||void 0===t?void 0:t.has_chat_in_fss)&&void 0!==n&&n;return"ON"===i&&s&&!o};a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/inband-screen/internals/message-field.module.out-vflBIPWhT.css",(e=>"._message-field_1uyu3_1{display:flex;flex-direction:column;flex-grow:1;margin-bottom:-3px;padding-top:0;position:relative}._message-field_1uyu3_1 textarea{background-color:var(--dig-color__background__base);border:1px solid var(--dig-color__border__subtle);flex-grow:1;height:auto}._message-field-with-banner_1uyu3_17 textarea{border-bottom-color:var(--dig-color__primary__surface--state-2);border-bottom-left-radius:0;border-bottom-right-radius:0;min-height:114px}._message-field-textarea-mobile_1uyu3_25{font-size:16px}._top-right-button_1uyu3_29{position:absolute;right:11px;top:8px}._summarized-banner_1uyu3_35{border:1px solid var(--dig-color__primary__surface--state-2);border-top:none;border-top-left-radius:0;border-top-right-radius:0;z-index:-1}._summarized-banner-message_1uyu3_44{color:var(--dig-color__primary__base);font-weight:500}._summarized-banner-icon_1uyu3_49{color:var(--dig-color__foldericon__icon)}"));const Qn="_message-field_1uyu3_1",Xn="_message-field-with-banner_1uyu3_17",ei="_message-field-textarea-mobile_1uyu3_25",ti="_summarized-banner_1uyu3_35",ai="_summarized-banner-message_1uyu3_44",ni="_summarized-banner-icon_1uyu3_49",ii=()=>{const e=i.useIntl(),t=ha(),n=o.useLogger(),r=l.useStore(t.$isInviteSending),[s,d]=M.useState(!1),[_,c]=M.useState(!1),[u,m]=M.useState(!1),[g,p]=M.useState(!1),f=M.useRef(!1),h=Zn(),[y,v]=M.useState(t.$inviteMessage.get()),[E,T]=M.useState(!1),S=M.useCallback((e=>{if(t.$isInviteMessageTooLong.set(e.currentTarget.value.length>2e3),h){""===e.currentTarget.value?(m(!1),p(!1),c(!1)):u&&!g&&p(!0)}n("SHARE_MODAL_SHARE__MESSAGE_CHANGED",null),v(e.currentTarget.value),t.$inviteMessage.set(e.currentTarget.value)}),[u,h,n,t,g]),w=A.is_mobile_or_tablet();M.useCallback((()=>{}),[]);const I=_&&!s&&Boolean(y);return M.useEffect((()=>{""===y&&h&&(m(!1),p(!1),c(!1))}),[y,h]),M.useEffect((()=>{let e=!1;const n=async()=>{d(!0);try{const{objectMetadataResult:n,oid:i}=t.$props.get(),r=await(async(e,t)=>{var n;const{isReady:i,fileId:r,fssSearchScope:o}=((e,t)=>{var a,n;if(!e||e.isLoading||e.isError)return{fileId:"",fssSearchScope:void 0,isReady:!1};const i=e.output;return i?{fileId:(null===(a=i.common_metadata)||void 0===a?void 0:a.file_id)||t.fileId||"",fssSearchScope:null===(n=i.common_metadata)||void 0===n?void 0:n.path_display,isReady:!0}:{fileId:"",fssSearchScope:void 0,isReady:!1}})(e,t);if(!i||!r)return null;try{const e=await a.getContextEngineApiClient(),t=((e,t)=>({conversation_id:"",user_message:{text:"Summarize this",rephrased:"",agent_ids:["summarize"],attachments:[{uuid:e,fss_retriever_info:{fss_file_identifier:{file_id:e}}}],agent_payload:"",llm_ignore:!1,fss_search_scope:t||"",stack_id_scope:""}}))(r,o),i=await e.rpc("conversations/get_response",t,{headers:a.getDefaultHeaders()}),s=((null==i?void 0:i.messages)||[]).find((e=>{var t;return"assistant_message"===(null===(t=e.message_type)||void 0===t?void 0:t[".tag"])}))||null;return s&&"assistant_message"===(null===(n=s.message_type)||void 0===n?void 0:n[".tag"])&&s.message_type.text?s.message_type.text:null}catch(e){return null}})(n,i);if(e)return;d(!1),r&&(v(r),t.$inviteMessage.set(r),c(!0),m(!0),p(!1))}catch(t){if(e)return;d(!1)}};return!h||y||f.current||(f.current=!0,n()),()=>{e=!0}}),[y,h,t]),M.createElement(a.Box,{className:a.cx(Qn,I?Xn:void 0),paddingTop:"Micro Large"},M.createElement(a.TextArea,{className:a.cx(w?ei:void 0),value:y,placeholder:s?Jt(e):qt(e),"aria-label":Vt(e),onChange:e=>{v(e.currentTarget.value),E||S(e)},disabled:r||s,"data-testid":"ib-message-field-textarea",onCompositionStart:()=>T(!0),onCompositionEnd:e=>{T(!1),S(e)}}),I&&M.createElement(a.Banner,{className:ti,type:"attention",variant:"basic",withLeftIcon:M.createElement(a.UIIcon,{src:a.Twinkle2Line,className:ni})},M.createElement(a.Banner.Message,{className:ai},(e=>e.formatMessage({id:"VlECo+",defaultMessage:"Summarized by Dash"}))(e))),!1)};ii.displayName="MessageField";a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/inband-screen/internals/share-modal-share.module.out-vflXLGzBa.css",(e=>"._action-row_1nkgf_1{display:flex;flex-direction:column;min-height:310px;row-gap:var(--dig-spacing__micro__medium);width:100%}._action-row-expand-from-accessory-area_1nkgf_12{animation:_action-row-expand-accessory-area_1nkgf_1 var(--duration__surface) var(--easing__transition) forwards;min-height:64px;overflow:hidden}._action-section_1nkgf_19{border:1px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__medium);position:relative;transition:border var(--duration__micro-fast) var(--easing__transition);z-index:1}._action-section-top_1nkgf_28{padding:var(--dig-spacing__micro__medium)}._action-section-active_1nkgf_32{border-color:var(--dig-color__secondary__base);box-shadow:none}._action-section-active_1nkgf_32,._action-section-active_1nkgf_32:hover,._action-section_1nkgf_19:focus-within{box-shadow:var(--dig-utilities__boxshadow__focus-ring);transition:box-shadow var(--duration__micro-fast) var(--easing__transition)}._accessory-section_1nkgf_44{animation:_fade-in_1nkgf_1 var(--duration__micro-fast) var(--easing__transition) forwards;display:flex;flex-direction:column;flex-grow:1;height:100%;row-gap:var(--dig-spacing__micro__medium);width:100%}._action-row-expand-from-accessory-area_1nkgf_12 ._accessory-section_1nkgf_44{animation:_fade-in_1nkgf_1 var(--duration__surface) var(--easing__transition) forwards}@media (prefers-reduced-motion:reduce){._action-row-expand-from-accessory-area_1nkgf_12,._action-row-expand-from-accessory-area_1nkgf_12 ._accessory-section_1nkgf_44{animation-timing-function:var(--easing__linear)}}@keyframes _action-row-expand-accessory-area_1nkgf_1{0%{max-height:64px;min-height:64px}to{min-height:286px;overflow:visible}}@keyframes _fade-in_1nkgf_1{0%{opacity:0}to{opacity:1}}._action-section-bottom_1nkgf_88{align-items:center;display:flex;height:32px;justify-content:space-between}._add-icon-small_1nkgf_96{height:var(--dig-spacing__dimension__24);margin-top:var(--dig-spacing__dimension__6);min-width:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}._add-icon-small_1nkgf_96 svg{height:var(--dig-spacing__dimension__16);width:var(--dig-spacing__dimension__16)}._add-icon_1nkgf_96,._add-icon_1nkgf_96>svg{transition:min-width var(--duration__surface) var(--easing__transition),width var(--duration__surface) var(--easing__transition),background-color var(--duration__surface) var(--easing__transition),color var(--duration__surface) var(--easing__transition),height var(--duration__surface) var(--easing__transition),margin-top var(--duration__surface) var(--easing__transition)}._add-icon-shrink_1nkgf_121{animation:_shrink-icon_1nkgf_1 var(--duration__micro-fast) var(--easing__transition) forwards}._add-icon-shrink_1nkgf_121>svg{animation:_shrink-icon-svg_1nkgf_1 var(--duration__micro-fast) var(--easing__transition) forwards}@keyframes _shrink-icon_1nkgf_1{0%{height:var(--dig-spacing__dimension__36);margin-top:0;min-width:var(--dig-spacing__dimension__36);width:var(--dig-spacing__dimension__36)}to{height:var(--dig-spacing__dimension__24);margin-top:5px;min-width:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}}@keyframes _shrink-icon-svg_1nkgf_1{0%{height:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}to{height:var(--dig-spacing__dimension__16);width:var(--dig-spacing__dimension__16)}}._add-members-directly-action-section_1nkgf_170{border-color:var(--dig-color__border__subtle);border-radius:var(--dig-radius__small);border-style:solid;border-width:2px;position:relative;z-index:1}._add-members-directly-action-section_1nkgf_170 ._add-icon_1nkgf_96{margin-top:0}._add-members-directly-action-section-active_1nkgf_183,._add-members-directly-action-section_1nkgf_170:focus-within{border-color:var(--dig-color__utility__focus-ring)}._add-members-directly-action-section-active_1nkgf_183 ._add-icon_1nkgf_96,._add-members-directly-action-section_1nkgf_170:focus-within ._add-icon_1nkgf_96,._add-members-directly-action-section_1nkgf_170:hover ._add-icon_1nkgf_96{background:var(--dig-color__primary__base);color:var(--dig-color__background__base)}._add-members-directly-action-section-bottom_1nkgf_195{padding:var(--dig-spacing__micro__medium);padding-top:var(--dig-spacing__micro__medium)}._add-members-directly-action-section-active_1nkgf_183 ._add-icon-sending_1nkgf_200,._add-members-directly-action-section_1nkgf_170:focus-within ._add-icon-sending_1nkgf_200,._add-members-directly-action-section_1nkgf_170:hover ._add-icon-sending_1nkgf_200{background:var(--dig-color__disabled__base)}._add-members-directly-action-section_1nkgf_170 ._add-icon-sending_1nkgf_200>svg,._add-members-directly-action-section-active_1nkgf_183 ._add-icon-sending_1nkgf_200>svg,._add-members-directly-action-section_1nkgf_170:focus-within ._add-icon-sending_1nkgf_200>svg,._add-members-directly-action-section_1nkgf_170:hover ._add-icon-sending_1nkgf_200>svg{color:var(--dig-color__disabled__on-surface)}"));const ri="_action-row_1nkgf_1",oi="_action-row-expand-from-accessory-area_1nkgf_12",si="_action-section_1nkgf_19",li="_action-section-top_1nkgf_28",di="_action-section-active_1nkgf_32",_i="_accessory-section_1nkgf_44",ci="_action-section-bottom_1nkgf_88",ui="_add-icon-small_1nkgf_96",mi="_add-icon_1nkgf_96",gi="_add-icon-shrink_1nkgf_121",pi="_add-members-directly-action-section_1nkgf_170",fi="_add-members-directly-action-section-active_1nkgf_183",hi="_add-icon-sending_1nkgf_200",yi=(e,t)=>{const a=e.linked_services.find((e=>e.service_type[".tag"]===t[".tag"]));return!!a&&"is_connected"===a.connection_state[".tag"]},vi=(e,t,a)=>{const n=e.linked_services.find((e=>e.service_type[".tag"]===t[".tag"]));return!!n&&n.granted_permissions.some((e=>e[".tag"]===a[".tag"]))},Ei=o.define({name:"profileServices.listLinkedServices"},(e=>()=>o.handler(e.profileServicesListLinkedServices()))),Ti=e=>e,Si=o.define({name:"sharing.targetsSearch"},(e=>async t=>{const a=await o.handler(e.sharingTargetsSearch(t));return"SUCCESS"===a.status?{status:o.Status.SUCCESS,output:a.output.entries.map(Ti)}:a})),wi=Symbol("ON_SHOW_SUGGESTIONS"),Ai=Symbol("ON_SELECT_SUGGESTION"),{useEmitter:Ii,defaultEmitter:bi}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),r=t(a.Context$6),o=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(r),...a.getTags$7(o)};e.key!==wi?e.key!==Ai||a.UDCL.logEvent("ops.sm24.select_tokenizer_suggestion",{tags:{...s,method:e.payload.method,suggestionIndex:e.payload.index.toString()}}):a.UDCL.logEvent("ops.sm24.show_tokenizer_suggestions",{tags:{...s,numSuggestions:e.payload.numSuggestions.toString()}})}));a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/targets-tokenizer/internals/targets-tokenizer.module.out-vflGehY5z.css",(e=>"._share-tokenizer_1l70k_1{color-scheme:var(--dig-color-scheme);margin-top:var(--dig-spacing__dimension__4);max-height:80px;max-height:64px;max-width:100%;min-height:32px;min-width:auto;overflow-y:hidden;width:100%}._share-tokenizer-with-targets_1l70k_16{overflow-y:scroll}._share-tokenizer-text-input-container_1l70k_20{border:none;box-shadow:none;cursor:text;outline:none;position:relative}._share-tokenizer-text-input-container_1l70k_20:focus-within{border:none;box-shadow:none;outline:none}._share-tokenizer-text-input-container_1l70k_20:has(input:focus){border:none;box-shadow:none;outline:none}._share-tokenizer-typeahead-container_1l70k_43{border-radius:var(--dig-radius__small);transform:translate(-14px,20px);width:calc(100% + 28px)}._share-tokenizer-with-targets_1l70k_16:not(._share-tokenizer_1l70k_1) ._share-tokenizer-typeahead-container_1l70k_43{transform:translate(-14px)}input._share-tokenizer-text-input_1l70k_20[type=text]{font-family:var(--type__body__standard--fontfamily);font-size:var(--type__body__standard--fontsize);line-height:var(--type__body__standard--lineheight_label);min-height:var(--dig-spacing__dimension__24);min-width:2ch;width:0}input._share-tokenizer-text-input-mobile_1l70k_66[type=text]{font-size:16px}._screen-reader-only_1l70k_70{height:1px;left:-10000px;overflow:hidden;position:absolute;top:auto;width:1px}"));const ki="_share-tokenizer_1l70k_1",Ri="_share-tokenizer-with-targets_1l70k_16",Ni="_share-tokenizer-text-input-container_1l70k_20",Mi="_share-tokenizer-typeahead-container_1l70k_43",Ci="_share-tokenizer-text-input_1l70k_20",Li="_share-tokenizer-text-input-mobile_1l70k_66",xi="_screen-reader-only_1l70k_70",Pi=e=>e.formatMessage({id:"+iNJRS",defaultMessage:"There was a problem completing this request."}),Oi=e=>e.formatMessage({id:"Au33+R",defaultMessage:"Successfully connected your contacts from Google"}),Di=e=>e.formatMessage({id:"sgP44K",defaultMessage:"Failed to connect your contacts from Google"}),Fi=e=>e.formatMessage({id:"ZusjWv",defaultMessage:"Suggested people"}),$i=e=>e.formatMessage({id:"6EE+ph",defaultMessage:"Suggested people list"}),Ui=e=>e.formatMessage({id:"CkYgqG",defaultMessage:"Sign in to import contacts"}),Hi=e=>e.formatMessage({id:"2/+46g",defaultMessage:"Connected"}),Bi=e=>e.formatMessage({id:"JbMFlW",defaultMessage:"Importing contacts"}),qi=/['&A-Za-z0-9\._%+-]+@[A-Za-z0-9-][A-Za-z0-9\.-]*\.[A-Za-z]{2,15}/gi,Ji=/[,|;>\s]/,Vi="Enter",ji="IMPORT_CONTACTS",Wi=[ji],Gi="Google",zi="/static/images/index/google-logo-color.svg",Ki=e=>(e.match(qi)||[]).map(j),Yi=e=>M.useCallback((t=>{const a=t.currentTarget.value,n=(i=a,Ji.test(i)?Ki(i):[]);var i;l.batch((()=>{e.$isTypeaheadForcedOpen.set(!1),n.length>0?(e.$inviteTargets.set([...e.$inviteTargets.get(),...n]),e.$query.set("")):e.$query.set(a)}))}),[e]),Zi=e=>e.map((e=>{if("email"===e[".tag"]||"user"===e[".tag"]){const t=e.email.trim();return t.length===e.email.length?e:{...e,email:t}}return e})),Qi=e=>{const t={};return e.filter((e=>{const a=W(e);return!t[a]&&(t[a]=!0,!0)}))},Xi=e=>{const t=(e=>{const t=o.useEndpoint(Si),a=o.useLogger(),n=i.useIntl(),r=s.useShowSharingNotifcation();return M.useCallback((async()=>{const i=e.$query.get(),o=await t({query:i,force_refresh:!1,limit:10});if(e.$query.get()===i){if(a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_START",null),"SUCCESS"!==o.status)return"ERROR"===o.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR",{response:o}):a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL",{response:o}),r({type:s.SharingNotificationType.FAILURE,message:Pi(n)}),void e.$searchSuggestionsRaw.set([]);a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS",{response:o}),l.batch((()=>{e.$latestSuggestionsQuery.set(i),e.$searchSuggestionsRaw.set(o.output)}))}}),[e,t,a,r,n])})(e);M.useEffect((()=>{const a=[e.$query.obs((e=>{t()}))];return()=>a.forEach((e=>e()))}),[e,t])},er=e=>{const t=o.useEndpoint(Ei);return M.useCallback((async()=>{if(e.$isLinkedServicesUpdating.get())return;const a=await t(null);"SUCCESS"===a.status?l.batch((()=>{e.$linkedServices.set(a.output),e.$isLinkedServicesUpdating.set(!1)})):l.batch((()=>{e.$linkedServices.set(null),e.$isLinkedServicesUpdating.set(!1)}))}),[e,t])},tr=e=>{const t=i.useIntl(),n=s.useShowSharingNotifcation(),r=o.useLogger(),l=er(e),d=o.useRedirectWindowToken();return M.useCallback((async()=>{if(e.$isConnectingToGoogle.get()||null===d)return;e.$isConnectingToGoogle.set(!0);let i=null;const o=()=>{n({type:s.SharingNotificationType.FAILURE,message:Di(t)}),null!==i&&clearInterval(i),window.removeEventListener("message",u),l().then((()=>{e.$isConnectingToGoogle.set(!1)}))},_=new URLSearchParams({service:"1",is_popup:"true",action:"link_contacts",prompt_select:"true",token:d,user_id:e.$user.get().id.toString(),is_desktop:"false"}),c=window.open(`/profile_services/start_auth_flow?${_.toString()}`,"Google","width=600,height=600,resizable=1,scrollbars=1");if(null===c)return o();i=setInterval((()=>{c.closed&&o()}),1e3);const u=d=>{let _;try{_=JSON.parse(d.data)}catch(e){return}if(a.isObjectOf({type:a.isExactly("db:profile_service:auth_complete"),payload:a.isObjectOf({success:a.isBoolean})})(_)){if(_.payload.success)return m=c,r("TEAMS_WEB",{name:a.TeamsWebEventName.ImportContactsComplete,extra:{provider:"google",path:window.location.pathname}}),n({type:s.SharingNotificationType.COMPLETED,message:Oi(t)}),null!==i&&clearInterval(i),window.removeEventListener("message",u),l().then((()=>{e.$isConnectingToGoogle.set(!1)})),void(null==m||m.close());var m;o(),c.close()}};window.addEventListener("message",u)}),[e,t,r,l,d,n])},ar=(e,t)=>"user"===e[".tag"]?s.getUserInitials(e.name,t.locale):"group"===e[".tag"]?s.getGroupInitials(e.name):"email"===e[".tag"]?"":a.exhausts(e,""),nr=(e,t)=>"user"===e[".tag"]?t&&t!==e.dbx_team_id?e.email:e.name:"group"===e[".tag"]?e.name:"email"===e[".tag"]?e.email:"",ir=({store:e,target:t,isDisabled:n,maxChars:r})=>{const o=i.useIntl(),d=((e,t)=>M.useCallback((()=>{const a=e.$inviteTargets.get().filter((e=>e!==t));l.batch((()=>{e.$inviteTargets.set(a),e.$query.set("")}))}),[e,t]))(e,t),_=e.$user.get().team_dbtid,c=s.Emstring.em_snippet(nr(t,_),null!=r?r:a.SNIPPET_SIZES.EMAIL_SHORT,.6),u="user"===t[".tag"]&&_&&_!==t.dbx_team_id?"":ar(t,o),m=G(t),g=W(t),p=l.useStore(e.$inviteTargetValidation)[g],f=p&&"allowed"===p.result[".tag"]&&"no_warning"!==p.result.allowed[".tag"]&&"not_dropbox_user"!==p.result.allowed[".tag"],h=p&&"disallowed"===p.result[".tag"],y=!!u||!!m,v=y&&M.createElement(a.Avatar,{src:m||"",size:"xsmall",hasNoOutline:!0,"aria-hidden":!0},u),E=((e,t)=>e.formatMessage({id:"cVF7dM",defaultMessage:"Sharing with {label} - press backspace or delete to remove"},{label:t}))(o,c);return M.createElement(I.Chip,{size:"small",onDelete:d,variant:f?"attention":h?"alert":"standard",disabled:n,"aria-label":E},y&&M.createElement(I.Chip.AvatarAccessory,null,v),M.createElement(I.Chip.Content,null,c))};ir.displayName="EmailChip";const rr=({target:e})=>{const t=i.useIntl(),n=W(e),r=ar(e,t),o=nr(e),s=z(e,t),l=G(e);return M.createElement(b.Typeahead.Row,{"data-testid":"typeahead-suggestion",className:"targets-tokenizer-suggestion",key:n,value:e,withTitle:o,withSubtitle:s,withLeftAccessory:M.createElement(a.Avatar,{src:l||void 0,hasNoOutline:!0,alt:o,"aria-hidden":"true"},r)})};rr.displayName="Suggestion";const or=({results:e,suggestionMax:t})=>M.createElement("div",{className:xi,"aria-live":"polite"},e.slice(0,t).map(((e,t)=>M.createElement("div",{key:t},e!==ji&&nr(e)))));or.displayName="ScreenReaderLiveResults";const sr=({store:e})=>{const t=i.useIntl(),n=l.useStore(e.$isConnectingToGoogle),r=l.useStore(e.$isConnectedToGoogle),s=l.useStore(e.$isLinkedServicesUpdating);return o.useRedirectWindowToken()?n?M.createElement(b.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:ji,withLeftAccessory:M.createElement(a.Avatar,{src:zi}),value:ji,withTitle:Gi,withSubtitle:Bi(t)}):s?null:r?M.createElement(b.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:ji,withLeftAccessory:M.createElement(a.Avatar,{src:zi}),value:ji,withTitle:Gi,withSubtitle:Hi(t)}):M.createElement(b.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:ji,withLeftAccessory:M.createElement(a.Avatar,{src:zi}),value:ji,withTitle:Gi,withSubtitle:Ui(t)}):null};sr.displayName="ImportContacts";const lr=e=>{var t;const n=(e=>{const{isNonUserRelativeContext:t}=a.useSharingApiContext();return l.useInitStore({props:e,isNonUserRelativeContext:t},(e=>{var t,n;const i=l.proxy((()=>e.get().props)),r=l.proxy((()=>e.get().isNonUserRelativeContext)),o=l.store(!1),s=l.store(!1),d=l.store(!1),_=l.store(null!==(t=i.get().autoFocus)&&void 0!==t&&t),c=l.store(!1),u=l.store(null),m=l.store(null!==(n=i.get().initialQuery)&&void 0!==n?n:""),g=l.store(""),p=l.proxy((()=>i.get().isActive)),f=l.proxy((()=>i.get().user)),h=l.proxy((()=>i.get().accessLevel)),y=l.proxy((()=>i.get().isEmailSectionActive)),v=l.proxy((()=>i.get().inviteTargets),(e=>i.get().onInviteTargetsChange(Zi(Qi(e))))),E=l.proxy((()=>i.get().inviteTargetValidation)),T=l.proxy((()=>v.get().length>0)),S=l.proxy((()=>i.get().objectMetadata)),w=l.proxy((()=>a.getCanInvite(S.get(),h.get()))),A=l.proxy((()=>{const e=u.get();return e?yi(e,{".tag":"google"})&&vi(e,{".tag":"google"},{".tag":"contacts"}):null})),I=l.proxy((()=>f.get().is_team)),b=l.proxy((()=>a.getIsTeamSharedFolder(S.get()))),k=l.proxy((()=>i.get().autoFocus)),R=l.proxy((()=>d.get())),N=l.store([]),M=l.proxy((e=>{const t=b.get(),a=f.get().email,n=v.get().map(W),i={},o=r.get(),s=N.get().filter((e=>{const r=W(e);return!(i[r]||(i[r]=!0,n.includes(r)||!H(t,f.get().is_tmr_member)&&"group"!==e[".tag"]||!(o||"email"!==e[".tag"]&&"user"!==e[".tag"]||e.email!==a)))}));return null!==e&&e.length===s.length&&e.every(((e,t)=>e===s[t]),!0)?e:s})),C=l.proxy((e=>{const t=b.get(),a=m.get(),n=t||""===a,i=[...M.get().slice(0,9),...n?[]:Wi];return null!==e&&e.length===i.length&&e.reduce(((e,t,a)=>e&&t===i[a]),!0)?e:i}));return{$accessLevel:h,$user:f,$canInvite:w,$inviteTargets:v,$inviteTargetValidation:E,$hasInviteTargets:T,$isConnectedToGoogle:A,$isConnectingToGoogle:o,$isFocused:s,$isLinkedServicesUpdating:d,$isTeamAccount:I,$isTeamFolder:b,$isTypeaheadForcedOpen:_,$isTypeaheadOpen:c,$isUpdatingGoogleConnectionStatus:R,$linkedServices:u,$objectMetadata:S,$query:m,$latestSuggestionsQuery:g,$searchSuggestionsRaw:N,$searchSuggestions:M,$suggestions:C,$isEmailSectionActive:y,$autoFocus:k,$isActive:p,$props:i}}))})(e),{isSuggestionsOpen:r,isInviteSending:d,isActionRowTransitionInProgress:_,inbandInputAreaRef:c,inputRef:u,inviteTargets:m,setSuggestionsOpen:g,onTargetsDropdownFocusChange:p}=e,f=i.useIntl(),h=M.useRef(null),y=l.useStore(n.$query),v=l.useStore(n.$inviteTargets),E=l.useStore(n.$hasInviteTargets),T=M.useRef(v.length),S=l.useStore(n.$suggestions),w=l.useStore(n.$canInvite),I=l.useStore(n.$isTypeaheadForcedOpen)&&w,k=null!==(t=l.useStore(n.$autoFocus))&&void 0!==t&&t;Xi(n),(e=>{const t=o.useEndpoint(Si),a=o.useLogger();M.useEffect((()=>{(async()=>{a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_START",null);const n=await t({query:"",force_refresh:!0,limit:10});"SUCCESS"===n.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS",{response:n}):"ERROR"===n.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR",{response:n}):a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL",{response:n}),"SUCCESS"===n.status&&e.$searchSuggestionsRaw.set(n.output)})()}),[])})(n),(e=>{const t=er(e);M.useEffect((()=>{t()}),[t])})(n),(e=>{const t=Ii(),a=l.useStore(e.$searchSuggestions),n=l.useStore(e.$isTypeaheadOpen);M.useEffect((()=>{if(n){const e=a.slice(0,9).length;e>0&&n&&t.select(wi).emit({numSuggestions:e})}}),[a,t,n])})(n);const R=(e=>{const t=Ii(),a=tr(e),n=l.useStore(e.$searchSuggestions);return M.useCallback(((i,r)=>{l.batch((()=>{var o,s;if(i===ji){if(e.$isTypeaheadForcedOpen.set(!0),e.$isConnectingToGoogle.get())return;if(e.$isConnectedToGoogle.get())return;return e.$query.set(""),void a()}t.select(Ai).emit({index:n.findIndex((e=>e===i)),method:r.nativeEvent instanceof KeyboardEvent?"keyboard":"click"}),e.$query.set(""),e.$inviteTargets.set([...e.$inviteTargets.get(),i]),null===(s=null===(o=e.$props.get().inputRef)||void 0===o?void 0:o.current)||void 0===s||s.focus()}))}),[e,a,t,n])})(n),N=(e=>{const t=Ii();return M.useCallback((a=>{const n=e.$query.get();if(a.key===Vi&&a.shiftKey)return void a.preventDefault();"Backspace"!==a.key&&"Delete"!==a.key||""===n&&e.$inviteTargets.get().length>0&&e.$inviteTargets.set(e.$inviteTargets.get().slice(0,-1));const i=n===e.$latestSuggestionsQuery.get(),r=qi.test(n);if(a.key===Vi){const a=document.getElementById("targets-tokenizer-input-search");if(a&&"scrollIntoView"in a&&a.scrollIntoView(),i&&!r&&e.$searchSuggestions.get().length>0)t.select(Ai).emit({index:0,method:"keyboard"}),l.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),e.$searchSuggestions.get()[0]]),e.$query.set("")}));else if(""!==n){const t=Ki(n);t.length>0?l.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),...t]),e.$query.set("")})):l.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),j(n)]),e.$query.set("")}))}}}),[e,t])})(n),C=Yi(n),{inputPlaceholder:L,truncatedInputPlaceholder:x}=(e=>{var t;const n=i.useIntl(),r=l.useStore(e.$hasInviteTargets),o=l.useStore(e.$isTeamFolder),d=l.useStore(e.$isTeamAccount),_=l.useStore(e.$user).is_tmr_member,c=null===(t=l.useStore(e.$props).shouldTruncatePlaceholder)||void 0===t||t;return M.useMemo((()=>{let e;return e=r?void 0:o&&!_?(e=>e.formatMessage({id:"VMGE6I",defaultMessage:"Group names"}))(n):d?(e=>e.formatMessage({id:"+nKRfb",defaultMessage:"Add an email, name, or group"}))(n):(e=>e.formatMessage({id:"bdV6O3",defaultMessage:"Add an email or name"}))(n),{inputPlaceholder:e,truncatedInputPlaceholder:c&&e?s.Emstring.em_snippet(e,a.SNIPPET_SIZES.TOKENIZER_PLACEHOLDER,1):e}}),[o,d,n,_,r,c])})(n),P=(e=>M.useCallback((({isOpen:t})=>{if(t)e.$isTypeaheadOpen.set(!0);else{const t=Ki(e.$query.get());l.batch((()=>{t.length>0&&(e.$inviteTargets.set([...e.$inviteTargets.get(),...t]),e.$query.set("")),e.$isTypeaheadForcedOpen.set(!1),e.$isTypeaheadOpen.set(!1),e.$isFocused.set(!1)}))}}),[e]))(n),O=(e=>M.useCallback((()=>{var t,a;null===(a=(t=e.$props.get()).onUserInteraction)||void 0===a||a.call(t),e.$isTypeaheadForcedOpen.set(!1),e.$isFocused.set(!0)}),[e]))(n),D=(e=>M.useCallback((t=>t===ji?M.createElement(sr,{store:e}):M.createElement(rr,{target:t})),[e]))(n),F=M.useRef(!1),$=M.useRef(void 0),U=d||!w,B=M.useCallback(((e,t)=>{const a=t.includes(ji)?t.length-1:t.length,n=e&&a>0;F.current!==n&&(F.current=n,null==p||p(n)),g(e)}),[p,g]);M.useEffect((()=>{const e=$.current;e&&(B(e.isOpen,e.suggestions),$.current=void 0)}));const q=M.useCallback((()=>{r||n.$isTypeaheadForcedOpen.set(!0)}),[n.$isTypeaheadForcedOpen,r]),J=M.useCallback((()=>{var e;null===(e=null==u?void 0:u.current)||void 0===e||e.focus()}),[u]);M.useEffect((()=>{w&&0===m.length&&!_&&J()}),[w,J,m,_]),M.useEffect((()=>{if(T.current<v.length){const e=document.getElementById("targets-tokenizer-input-search");e&&"scrollIntoView"in e&&e.scrollIntoView()}T.current=v.length}),[v.length]);const V=A.is_mobile_or_tablet();return M.createElement(a.DIGContext.Provider,{value:{featureLevel:"experimental"}},M.createElement(b.Typeahead.Wrapper,{className:a.cx(ki,ki,{[Ri]:E}),onSelection:R,hasMaxHeight:!0,isPortaled:V,onToggle:P},(({getTriggerProps:e,getContentProps:t})=>{const{open:i,...r}=t({}),o=(i||I)&&S.length>0;return $.current={isOpen:o,suggestions:S},M.createElement(M.Fragment,null,M.createElement(a.TextInput.Container,{className:a.cx(Ni),ref:h,size:"small",onClick:J,"data-uxa-log":"sm24-tokenizer","data-uxa-interactions":"shown"},M.createElement(a.TextInput.ChipsContainer,null,v.map(((e,t)=>M.createElement(ir,{store:n,key:t,target:e,isDisabled:U}))),M.createElement(a.TextInput.Input,{...e({onChange:C,onKeyDown:N,onFocus:O}),className:a.cx(Ci,{[Li]:V}),ref:u,disabled:U,value:y,"aria-label":L,placeholder:x,"data-testid":"targets-tokenizer-input",id:"targets-tokenizer-input-search",autoComplete:"off",autoFocus:k,onClick:q}))),M.createElement(b.Typeahead.Container,{...r,triggerRef:c,open:o,"data-testid":"typeahead-container",className:Mi,auto:!1,placement:"bottom","aria-label":$i(f)},M.createElement(or,{results:S,suggestionMax:3}),M.createElement(b.Typeahead.Results,{title:Fi(f),results:S,renderRow:D,initialResults:""===y?3:10,maxResults:10})))})))};lr.displayName="TargetsTokenizer";const dr=M.memo((({isActive:e,objectMetadata:t,accountMetadata:a,inbandInputAreaRef:n,inputRef:i,onFocusChange:r,isActionRowTransitionInProgress:d,initialQuery:_})=>{const c=ha(),u=l.useStore(c.$inviteTargets),m=l.useStore(c.$inviteTargetValidations),g=l.useStore(c.$isInviteSending),p=l.useAtom(c.$sharingAccessLevel),f=(e=>M.useMemo((()=>s.convertAccountMetadataToUser(e)),[e]))(a),h=l.useStore(c.$isSuggestionsOpen),y=M.useCallback((e=>{c.$isSuggestionsOpen.set(e)}),[c.$isSuggestionsOpen]),{shouldStyleForSM21:v}=l.useAtom(c.$props),E=(()=>{const e=o.useLogger(),t=ha();return M.useCallback((a=>{e("SHARE_MODAL_SHARE__INVITE_TARGETS__CHANGE",null),t.$props.get().onInviteTargetsChange(a)}),[t,e])})();return M.createElement(lr,{accessLevel:p,objectMetadata:t,inviteTargets:u,onInviteTargetsChange:E,onTargetsDropdownFocusChange:r,inviteTargetValidation:m,user:f,isInviteSending:g,inbandInputAreaRef:n,inputRef:i,isActive:e,isSuggestionsOpen:h,setSuggestionsOpen:y,shouldTruncatePlaceholder:v,isActionRowTransitionInProgress:d,initialQuery:_})}));dr.displayName="TargetsTokenizer";const _r=({objectMetadata:e,accountMetadata:t,sharingPrefs:n,onCloseClick:r,isConfidentialFolderBannerClosed:s})=>{var d;const _=i.useIntl(),c=ha(),u=M.useRef(null),m=M.useRef(null),g=o.usePlatform()===o.Platforms.METASERVER,{shouldStyleForSM21:p,initialInput:f,onInitialInputUsed:h,onConfidentialFolderBannerClose:y}=l.useAtom(c.$props),v=l.useAtom(c.$isInviteSending),E=l.useAtom(c.$inviteTargets),T=l.useAtom(c.$isConfidentialFolder),S=l.useAtom(c.$isInviteMessageTooLong);M.useEffect((()=>{f&&h&&h()}),[f,h]);const w=Bn(e),A=qn(e,n),I=(()=>{const e=ha();return M.useCallback((t=>{e.$changeConfidentialityData.set({teamName:t})}),[e.$changeConfidentialityData])})(),b=null!==(d=a.getOwnerTeamName(e))&&void 0!==d?d:"",N=l.useAtom(c.$isSuggestionsOpen),C=E.length>0,{shouldTransitionAccessoryAreaEnter:L}=l.useAtom(c.$props),[x,P]=M.useState(!1),[O,D]=M.useState(L),{onStartInband:F}=l.useAtom(c.$props),$=l.useAtom(c.$componentViewTime),U=M.useRef(!1),H=Un();M.useEffect((()=>{if(!U.current&&$>0){U.current=!0;const e=Date.now()-$;F&&F(),H.select(kn).emit({timeSinceView:e})}}),[$,H,F]);const B=M.useCallback((()=>{D(!1)}),[D]);return M.createElement("div",{className:a.cx(ri,{[oi]:L}),onAnimationEnd:B},M.createElement("div",{id:"shareme24-ib-action-container",style:{width:"100%"},"data-testid":"ib-action-area",role:"region"},M.createElement(a.Box,{className:"banner-group",marginBottom:T?"Micro Small":"0"},!s&&T?M.createElement(Ct,{teamName:b,parentFolderName:a.getParentFolderName(e),isRestoreAccessEnabled:a.getCanDoAction(e,a.UPDATE_CONFIDENTIALITY_TAG),onRestoreAccessClick:I,onBannerClose:y}):null,M.createElement(zn,{objectMetadata:e})),M.createElement(a.Box,{flexDirection:"column",className:p?a.cx(pi,{[fi]:x||N}):a.cx(si,{[di]:x||N}),backgroundColor:"Background Base",onClick:()=>{!(null==m?void 0:m.current)||C||N||m.current.focus()}},M.createElement(a.Box,{className:li},M.createElement(a.Box,{ref:u,display:"flex",flexDirection:"row",style:{minHeight:"var(--dig-spacing__dimension__36)"},alignItems:"center"},M.createElement(a.Box,{className:a.cx(mi,{[ui]:p,[gi]:!p,[hi]:v}),borderRadius:"Circular",display:"flex",alignItems:"center",justifyContent:"center"},M.createElement(a.UIIcon,{src:R.ShareLine,size:"medium"})),M.createElement(dr,{isActive:x||N,objectMetadata:e,accountMetadata:t,inbandInputAreaRef:u,inputRef:m,onFocusChange:P,isActionRowTransitionInProgress:O,initialQuery:f}))))),M.createElement("div",{className:_i},w&&M.createElement(Kn,{message:w.message,variant:w.level}),S&&M.createElement(a.Banner,{type:"alert",withLeftIcon:M.createElement(a.UIIcon,{src:a.FailLine,"data-testid":"ib-message-above-limit-banner"})},M.createElement(a.Banner.Message,null,((e,t)=>e.formatMessage({id:"dH+HYp",defaultMessage:"Message must be under {limit} characters."},{limit:t}))(_,2e3))),M.createElement(ii,null),M.createElement(a.Box,{className:ci},M.createElement(Sa,null),v?(()=>{const e=jt(_);return M.createElement(a.Box,{display:"flex"},M.createElement(a.Box,{marginRight:"Micro XSmall"},M.createElement(a.Spinner,{size:"xsmall","aria-valuetext":null==e?void 0:e.toString(),monochromatic:!0,withTrack:!0})),M.createElement(a.Text,null,e))})():M.createElement(a.Button,{disabled:v||null!=w&&"error"===w.level||!C||S,style:{flexShrink:0,alignSelf:"center"},onClick:()=>{g?k.showOQModalOrContinue({beforeShowModal:()=>{r()},show:k.Show.EnforceRestrictionsOnly,action:"share_add_people",continueCallback:()=>A(),abortCallback:()=>{}}):A()},variant:"primary",size:"medium",fullWidth:!1,"data-uxa-log":"sharing-modal-footer-button-send-email","data-testid":"ib-share-send-email-button"},Wt(_,v)))))};_r.displayName="InbandShare";const cr=()=>{const e=ha(),t=l.useAtom(e.$props),{accountMetadataResult:a,objectMetadataResult:n,sharingPrefsResult:i,onCloseClick:r,isConfidentialFolderBannerClosed:o}=t,s=n.isLoading,d=!n.isLoading&&!n.isError,_=a.isLoading,c=!a.isLoading&&!a.isError,u=i.isLoading,m=!i.isLoading&&!i.isError,g=d&&c&&m;return s||_||u?M.createElement(ma,null):g?M.createElement(mr,{objectMetadata:n.output,accountMetadata:a.output,sharingPrefs:i.output,onCloseClick:r,isConfidentialFolderBannerClosed:o}):null};cr.displayName="InbandWithStore";const ur=e=>M.createElement(ya,{...e},M.createElement(cr,null));ur.displayName="Inband";const mr=({objectMetadata:e,accountMetadata:t,sharingPrefs:a,onCloseClick:n,isConfidentialFolderBannerClosed:i})=>{const s=ha(),d=l.useAtom(s.$inviteTargets),_=l.useAtom(s.$sharingAccessLevel);return Ia(e),M.useEffect((()=>{s.$componentViewTime.set(Date.now())}),[s]),M.createElement(r.AbuseFpjsProvider,{loadingComponent:M.createElement(ma,null)},M.createElement(o.MetadataProvider,{sharingInviteTargets:d,sharingAccessLevel:_},M.createElement(_r,{objectMetadata:e,accountMetadata:t,sharingPrefs:a,onCloseClick:n,isConfidentialFolderBannerClosed:i})))};mr.displayName="InbandInner",t.Context=kt,t.DOMAIN_RESTRICTION_FETCH_KEY=yn,t.EDITOR=Nt,t.Inband=ur,t.LoadingScreen=ma,t.PAP_Select_FlexibleSharingEntrypointAction=Mt,t.SharingSettingsUtil=e=>({getLinkPolicy:e=>({link_password:C(e.link_permissions)?void 0:"",expires:e.expires,allow_download:e.link_permissions.allow_download,audience:x(e.link_permissions),require_password:e.link_permissions.require_password}),getModifiedSettings:(t,a,n)=>{if(a===n)return;const i={},r=null!=t.expires&&null==a.expires;if(a.audience!==n.audience&&(i.audience=a.audience),a.allow_download!==n.allow_download&&(i.allow_download=a.allow_download),a.expires&&t.link_permissions.can_set_expiry&&(i.expires=a.expires.toISOString().split(".")[0]+"Z"),a.require_password!==n.require_password&&(i.require_password=a.require_password),"password"===a.audience||a.require_password)if(a.link_password)i.require_password=!0,i.link_password=a.link_password;else if(""===a.link_password)return{error:e.formatMessage({id:"wFrAfD",defaultMessage:"Password can’t be empty"})};return Object.keys(i).length<=0&&!r?void 0:{url:t.url,settings:i,remove_expiration:r}}}),t.VIEWER=Rt,t.canCreateLink=function(e,t,a,n,i,r,o,s,l,d,_,c){switch(e){case"editor":return a?r&&H(n,c)&&!i:H(n,c)&&l;case"viewer":return!("writer"===d&&!_)&&(t?s:H(n,c)&&s||o);default:return!1}},t.canCreateLinksForFolder=H,t.canModifyExpire=function(e){const t=e.link_permissions;return Boolean(t.can_set_expiry)},t.canModifyPassword=function(e){return Boolean(e&&e.can_set_password)||L(e)},t.canToggleExpire=function(e){const t=e.link_permissions;return Boolean(null!=e.expires?t.can_remove_expiry:t.can_set_expiry)},t.canTogglePassword=function(e){return Boolean(e&&e.require_password?e.can_remove_password:e.can_set_password)||L(e)},t.convertContactToInviteTarget=e=>e.type===a.ContactTypes.EMAIL?e.name&&e.name.length?{".tag":"user",dbx_team_id:e.dbx_team_id||"",...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,sort_key:e.name,dbx_account_id:e.dbx_account_id||"",email:e.email||""}:j(e.email||""):e.type===a.ContactTypes.NEW_STYLE_GROUP?{".tag":"group",dbx_team_id:e.dbx_team_id||"",members:e.members||"",name:e.name,sort_key:e.name,group_id:e.group_id||"",group_size:e.group_size||0}:e.type===a.ContactTypes.DBX_ID?{".tag":"user",dbx_team_id:e.dbx_team_id||"",...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,sort_key:e.name,dbx_account_id:e.dbx_account_id||"",email:e.email||""}:j(""),t.convertContentInfoToObjectIdentifier=e=>{var t,a,n,i;return e.isSharedFolder()?{".tag":"shared_folder",sharedFolderId:String(e.sharedFolderId()),fileId:null!==(t=e.fileId())&&void 0!==t?t:""}:e.isFileFolder()?{".tag":"file_folder",name:e.name(),path:null!==(a=e.displayPath())&&void 0!==a?a:"",fileId:null!==(n=e.fileId())&&void 0!==n?n:""}:{".tag":"file",fileId:null!==(i=e.fileId())&&void 0!==i?i:""}},t.convertInviteTargetToContact=at,t.convertLinkAccessLevelToSdkLinkAccessLevel=rt,t.convertLinksMetadataToSdkLinksMetadata=e=>{if(void 0===e)throw new Error("Adapt error");const t=[];for(const s of e)t.push((i=void 0,r=void 0,o=void 0,{".tag":(n=s).file_type,url:n.url,id:n.id,name:n.name,expires:a.convertExpirationDateToString(n.expires),path_lower:n.path_lower,link_permissions:(r=n.link_permissions,{resolved_visibility:r.resolved_visibility?(o=r.resolved_visibility,"public"===o?Y:"team_only"===o?Z:"password"===o?Q:"team_and_password"===o?X:"shared_folder_only"===o?ee:"no_one"===o?te:"only_you"===o?ae:a.exhausts(o,ne)):void 0,requested_visibility:r.requested_visibility?ot(r.requested_visibility):void 0,can_revoke:r.can_revoke,visibility_policies:[],can_set_expiry:r.can_set_expiry,can_remove_expiry:r.can_remove_expiry,allow_download:r.allow_download,can_allow_download:r.can_allow_download,can_disallow_download:r.can_disallow_download,restricting_shared_folder_path:r.restricting_shared_folder_path,allow_comments:r.allow_comments,team_restricts_comments:r.team_restricts_comments,effective_audience:r.effective_audience?st(r.effective_audience):void 0,audience_options:Tt(r.audience_options),link_access_level:rt(r.link_access_level),can_set_password:r.can_set_password,can_remove_password:r.can_remove_password,require_password:r.require_password,can_use_extended_sharing_controls:r.can_use_extended_sharing_controls,days_to_expire_policy:St(r.days_to_expire_policy),change_shared_link_expiration_policy:wt(r.change_shared_link_expiration_policy),enforce_shared_link_password_policy:At(r.enforce_shared_link_password_policy)}),team_member_info:n.team_member_info?(i=n.team_member_info,{team_info:It(i.team_info),display_name:i.display_name,member_id:i.member_id}):void 0,content_owner_team_info:n.content_owner_team_info?It(n.content_owner_team_info):void 0,preview_type:n.preview_type}));var n,i,r,o;return{links:t,has_more:!1}},t.convertSharingInfoToSdkAccountMetadata=e=>{const t=e.user();return{user_id:t.id,email:t.email,account_id:t.account_id,root_info:{".tag":"user",root_namespace_id:"ns_id",home_namespace_id:"ns_id"},is_paid:!!t.paid,role:t.role,is_family_user:!0===e.isFamilyUser(),is_team_member:!!t.is_team,team_policies:ct(e.teamPolicy()),team_id:t.team_dbtid,is_team_admin:t.is_team_admin,team_name:t.team_name,can_use_extended_sharing_controls:!0===e.canUseExtendedSharingControls(),is_tmr_member:t.is_tmr_member,is_paired:!0===e.isPaired()}},t.convertSharingInfoToSdkInviteTargetValidation=(e,t)=>{const a=t.recipientAccess(),n=t.recipientValidation()[a]||{},i=e.map(at).map((e=>e.getKey())),r=e.map(W),o=r.reduce(((e,t,a)=>({[t]:n[i[a]],...e})),{});return r.reduce(((e,t)=>{const a=o[t];if(!a)return e;const n={member:{".tag":"other"},result:nt(a),target_invite_eligibility:{".tag":"other"}};return{...e,[t]:n}}),{})},t.convertSharingInfoToSdkObjectMetadata=e=>_t(e.metadata(),!0===e.contentInfo().isFolderInsideTeamFolderTree(),!0===e.contentInfo().isTeamSharedFolder()),t.convertSharingInfoToSdkSharingPrefs=e=>{const t=e.sharingPrefs();if(void 0===t)throw new Error("Adapt error");return{invite_after_sharing_modal_variant:bt(t.invite_after_sharing_modal_variant),has_seen_esign_post_sharing:t.has_seen_esign_post_sharing,is_in_esign_post_sharing_exclusion_period:t.is_in_esign_post_sharing_exclusion_period,bsx_organize_around_people:t.bsx_organize_around_people,is_showing_file_upload_toolkit_campaign:t.is_showing_file_upload_toolkit_campaign,default_sharing_access_level_setting:t.default_sharing_access_level_setting,default_sharing_link_audience_setting:t.default_sharing_link_audience_setting,last_seen_team_policy_audience:t.last_seen_team_policy_audience,core_act_docsend_advanced_sharing:t.core_act_docsend_advanced_sharing,create_view_folder_link_enabled:t.create_view_folder_link_enabled,num_available_licenses:t.num_available_licenses}},t.convertSharingInfoToSdkUser=e=>{const t=e.user();return{id:t.id,email:t.email,is_team:!!t.is_team,is_team_admin:t.is_team_admin,account_id:t.account_id,team_dbtid:t.team_dbtid,is_tmr_member:t.is_tmr_member}},t.createFromEmail=j,t.createSdkObjectMetadata=_t,t.daysAfterToday=e=>{const t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),((e,t,a,n,i,r)=>(null==t&&(t=0),null==a&&(a=0),null==n&&(n=0),null==i&&(i=0),null==r&&(r=0),e.setFullYear(e.getFullYear()+t),e.setMonth(e.getMonth()+a),e.setDate(e.getDate()+n),e.setHours(e.getHours()+i),e.setMinutes(e.getMinutes()+r),e))(t,0,0,e)},t.daysExpirationPolicyToNumber=P,t.formatSubTitle=z,t.getAudienceForLink=x,t.getAvatarUrl=G,t.getDoesServiceHavePermissionGranted=vi,t.getInviteAfterSharingUsers=q,t.getIsServiceConnected=yi,t.getLinkControlPolicyWarningText=function(e,t,a,n){let i="";if(U(e,a)){const e=$(a),t=F(a);i=n.formatMessage({id:"GoACO+",defaultMessage:"Your admin requires {requirements, select, 0 {an expiration and a password} 1 {a password} 2 {an expiration} other{}} for links shared outside the team. To change the link setting, delete the link and create it again."},{requirements:e&&t?0:t?1:2})}else t.display_expiration_warning?i=n.formatMessage({id:"ySRXj8",defaultMessage:"Your admin {show_password_text, select, true {requires a password and } other {}}has set an expiration for all links shared outside the team. This link will expire in {days_to_expire, plural, =365 {1 year} one {# day} other {# days}}.{expiration_enforced, select, true { You can change or remove this expiration.} other {}}"},{days_to_expire:P[a.days_to_expire_policy],expiration_enforced:"allowed"===a.change_shared_link_expiration_policy,show_password_text:!!t.display_password_warning}):t.display_password_warning&&(i=n.formatMessage({id:"lcVbzE",defaultMessage:"Your admin requires to set a password for links shared outside the team."}));return i},t.getResolutionMethodFlags=function(e=[]){return{resolutionMethodChangeEmailIncluded:e.includes(t.ResolutionMethod.CHANGE_EMAIL),resolutionMethodJoinExistingTeamIncluded:e.includes(t.ResolutionMethod.JOIN_EXISTING_TEAM),resolutionMethodStartTrialIncluded:e.includes(t.ResolutionMethod.START_TRIAL),resolutionMethodPurchasePlanIncluded:e.includes(t.ResolutionMethod.PURCHASE_PLAN)}},t.getUniqueId=W,t.hasLinkPassword=C,t.invalidateSharingPrefs=async function(){return a.sharingPrefsPackage.invalidateQueries(d.queryClient)},t.isExpirationPolicyEnforcedByAdmin=$,t.isExpirationPolicySetByAdmin=D,t.isExternalAudience=O,t.isMemberInviteModal=J,t.isPasswordPolicyEnforcedByAdmin=F,t.isReadOnlyPolicy=U,t.listLinkedServices=Ei,t.shouldShowModalVariant=V,t.targetsSearch=Si,t.useDomainRestriction=En,t.useSharingPrefs=ca}));
//# sourceMappingURL=c_inband-screen_internals_share-modal-share.js-vflkSsUdY.map

//# debugId=800d496f-9984-3f95-ac72-4ad18387e0b2